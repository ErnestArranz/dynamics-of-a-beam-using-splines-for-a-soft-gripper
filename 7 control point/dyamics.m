clear
close all
clc
% Time span for the simulation

tspan = [0 6]; 

% Initial conditions:
% [ x1, x2, y2, x3, y3, x4, y4, x5, y5, x6, y6, vx1, vx2, vy2, vx3, vy3, vx4, vy4, vx5, vy5, vx6, vy6 ]
L = 1;
X0 = [L/6, 2*L/6, 0, 3*L/6, 0, 4*L/6, 0, 5*L/6, 0, L, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];

% Solve the ODE system using ode45
[t, X] = ode45(@myStateSpace, tspan, X0);

% 1. Plot positions (x1, x2, y2, x3, y3, x4, y4, x5, y5, x6, y6)
subplot(2, 2, 1);
plot(t, X(:,1), 'b-', t, X(:,2), 'b--', t, X(:,3), 'r-', t, X(:,4), 'g-', t, X(:,5), 'g--', t, X(:,6), 'm-', t, X(:,7), 'm--', t, X(:,8), 'c-', t, X(:,9), 'c--', t, X(:,10), 'k-', t, X(:,11), 'k--');
xlabel('Time');
ylabel('Position');
title('Positions');
legend('x1', 'x2', 'y2', 'x3', 'y3', 'x4', 'y4', 'x5', 'y5', 'x6', 'y6');
grid on;

% 2. Plot velocities (vx1, vx2, vy2, vx3, vy3, vx4, vy4, vx5, vy5, vx6, vy6)
subplot(2, 2, 2);
plot(t, X(:,12), 'b-', t, X(:,13), 'b--', t, X(:,14), 'r-', t, X(:,15), 'g-', t, X(:,16), 'g--', t, X(:,17), 'm-', t, X(:,18), 'm--', t, X(:,19), 'c-', t, X(:,20), 'c--', t, X(:,21), 'k-', t, X(:,22), 'k--');
xlabel('Time');
ylabel('Velocity');
title('Velocities');
legend('vx1', 'vx2', 'vy2', 'vx3', 'vy3', 'vx4', 'vy4', 'vx5', 'vy5', 'vx6', 'vy6');
grid on;

% 3. Plot trajectories (x1 vs y1, x2 vs y2, x3 vs y3, x4 vs y4, x5 vs y5, x6 vs y6)
subplot(2, 2, 3);
plot(X(:,1), zeros(length(X),1), 'b-', X(:,2), X(:,3), 'r-', X(:,4), X(:,5), 'g-', X(:,6), X(:,7), 'm-', X(:,8), X(:,9), 'c-', X(:,10), X(:,11), 'k-');
xlabel('X Position');
ylabel('Y Position');
title('Trajectories');
legend('P1', 'P2', 'P3', 'P4', 'P5', 'P6');
grid on;
axis equal;

% 4. Plot length of the beam over time using BÃ©zier curve length formula
subplot(2, 2, 4);
beam_length = arrayfun(@(i) bezier_length([0 0],[X(i,1), 0], [X(i,2), X(i,3)], [X(i,4), X(i,5)], [X(i,6), X(i,7)], [X(i,8), X(i,9)], [X(i,10), X(i,11)]), 1:length(t));
plot(t, beam_length, 'g-');
xlabel('Time');
ylabel('Beam Length');
title('Beam Length Over Time');
grid on;

% Calculate distances between control points
P0 = [0, 0]; % Origin
distances_P0P1 = zeros(length(t), 1);
distances_P1P2 = zeros(length(t), 1);
distances_P2P3 = zeros(length(t), 1);
distances_P3P4 = zeros(length(t), 1);
distances_P4P5 = zeros(length(t), 1);
distances_P5P6 = zeros(length(t), 1);

for i = 1:length(t)
    P1 = [X(i,1), 0];
    P2 = [X(i,2), X(i,3)];
    P3 = [X(i,4), X(i,5)];
    P4 = [X(i,6), X(i,7)];
    P5 = [X(i,8), X(i,9)];
    P6 = [X(i,10), X(i,11)];
    
    % Calculate Euclidean distances
    distances_P0P1(i) = norm(P1 - P0);
    distances_P1P2(i) = norm(P2 - P1);
    distances_P2P3(i) = norm(P3 - P2);
    distances_P3P4(i) = norm(P4 - P3);
    distances_P4P5(i) = norm(P5 - P4);
    distances_P5P6(i) = norm(P6 - P5);
end

% Create a new figure for distances between control points
figure;
plot(t, distances_P0P1, 'b-', t, distances_P1P2, 'r-', t, distances_P2P3, 'g-', t, distances_P3P4, 'm-', t, distances_P4P5, 'c-', t, distances_P5P6, 'k-');
xlabel('Time');
ylabel('Distance');
title('Distances Between Control Points');
legend('P0-P1', 'P1-P2', 'P2-P3', 'P3-P4', 'P4-P5', 'P5-P6');
grid on;

% Calculate energies

%mechanical properties
D = 0.02;
E = 206e5;
I = (pi/64)*D^4;
rho = 1000;
A = (pi*D^2)/4; 
mu = rho*A;
L = 1;
l=L;

function length = bezier_length(P0, P1, P2, P3, P4, P5, P6)
    % Define control point coordinates
    x0 = P0(1); y0 = P0(2);
    x1 = P1(1); y1 = P1(2);
    x2 = P2(1); y2 = P2(2);
    x3 = P3(1); y3 = P3(2);
    x4 = P4(1); y4 = P4(2);
    x5 = P5(1); y5 = P5(2);
    x6 = P6(1); y6 = P6(2);

    % Derivatives dx/dt and dy/dt as anonymous functions for sextic bezier
    dxdt = @(t) ...
        6*(1 - t).^5 * (x1 - x0) + ...
        30*(1 - t).^4.*t * (x2 - x1) + ...
        60*(1 - t).^3.*t.^2 * (x3 - x2) + ...
        60*(1 - t).^2.*t.^3 * (x4 - x3) + ...
        30*(1 - t).*t.^4 * (x5 - x4) + ...
        6*t.^5 * (x6 - x5);

    dydt = @(t) ...
        6*(1 - t).^5 * (y1 - y0) + ...
        30*(1 - t).^4.*t * (y2 - y1) + ...
        60*(1 - t).^3.*t.^2 * (y3 - y2) + ...
        60*(1 - t).^2.*t.^3 * (y4 - y3) + ...
        30*(1 - t).*t.^4 * (y5 - y4) + ...
        6*t.^5 * (y6 - y5);

    % Arc length integrand
    integrand = @(t) sqrt(dxdt(t).^2 + dydt(t).^2);

    % Numerically integrate from t = 0 to t = 1
    length = integral(integrand, 0, 1);
end

function dXdt = myStateSpace(t, X)
    % Extract variables from the state vector
    x_1 = X(1);
    x_2 = X(2);
    y_2 = X(3);
    x_3 = X(4);
    y_3 = X(5);
    x_4 = X(6);
    y_4 = X(7);
    x_5 = X(8);
    y_5 = X(9);
    x_6 = X(10);
    y_6 = X(11);
    vx1 = X(12);
    vx2 = X(13);
    vy2 = X(14);
    vx3 = X(15);
    vy3 = X(16);
    vx4 = X(17);
    vy4 = X(18);
    vx5 = X(19);
    vy5 = X(20);
    vx6 = X(21);
    vy6 = X(22);
    
    
    %mechanical properties
    D = 0.02;
    E = 206e5;
    I = (pi/64)*D^4;
    rho = 1000;
    A = (pi*D^2)/4; 
    mu = rho*A;
    L = 1;
    l=L;

    %damping coefficient
    c=3.5;

   % Define forces (if F!=0 when calculating equations of motion)
    if t >= 0 && t <= 6
        Fy6 = -0.75; % Force applied to the 6th control point
    else
        Fy6 = 0;
    end
 
    % Bending and stretching terms
    ben1 = @(u) (5.*(u - 1).^3.*((6.*u.^5.*y_6 - 6.*u.^5.*y_5 + 30.*u.*y_2.*(u - 1).^4 - 30.*u.^4.*y_5.*(u - 1) + 15.*u.^4.*y_4.*(2.*u - 2) + 60.*u.^2.*y_2.*(u - 1).^3 - 60.*u.^2.*y_3.*(u - 1).^3 - 60.*u.^3.*y_3.*(u - 1).^2 + 60.*u.^3.*y_4.*(u - 1).^2).*(30.*x_2 - 60.*x_1 + 360.*u.*x_1 - 360.*u.*x_2 + 120.*u.*x_3 - 720.*u.^2.*x_1 + 1080.*u.^2.*x_2 + 600.*u.^3.*x_1 - 720.*u.^2.*x_3 - 1200.*u.^3.*x_2 - 180.*u.^4.*x_1 + 180.*u.^2.*x_4 + 1200.*u.^3.*x_3 + 450.*u.^4.*x_2 - 600.*u.^3.*x_4 - 600.*u.^4.*x_3 + 120.*u.^3.*x_5 + 450.*u.^4.*x_4 - 180.*u.^4.*x_5 + 30.*u.^4.*x_6) + (6.*x_1.*(u - 1).^5 + 6.*u.^5.*x_5 - 6.*u.^5.*x_6 + 30.*u.*x_1.*(u - 1).^4 - 30.*u.*x_2.*(u - 1).^4 + 30.*u.^4.*x_5.*(u - 1) - 15.*u.^4.*x_4.*(2.*u - 2) - 60.*u.^2.*x_2.*(u - 1).^3 + 60.*u.^2.*x_3.*(u - 1).^3 + 60.*u.^3.*x_3.*(u - 1).^2 - 60.*u.^3.*x_4.*(u - 1).^2).*(30.*y_2 - 360.*u.*y_2 + 120.*u.*y_3 + 1080.*u.^2.*y_2 - 720.*u.^2.*y_3 - 1200.*u.^3.*y_2 + 180.*u.^2.*y_4 + 1200.*u.^3.*y_3 + 450.*u.^4.*y_2 - 600.*u.^3.*y_4 - 600.*u.^4.*y_3 + 120.*u.^3.*y_5 + 450.*u.^4.*y_4 - 180.*u.^4.*y_5 + 30.*u.^4.*y_6)).*(y_2 - 9.*u.*y_2 + 4.*u.*y_3 + 36.*u.^2.*y_2 - 32.*u.^2.*y_3 - 64.*u.^3.*y_2 + 6.*u.^2.*y_4 + 92.*u.^3.*y_3 + 51.*u.^4.*y_2 - 42.*u.^3.*y_4 - 104.*u.^4.*y_3 - 15.*u.^5.*y_2 + 4.*u.^3.*y_5 + 81.*u.^4.*y_4 + 40.*u.^5.*y_3 - 24.*u.^4.*y_5 - 45.*u.^5.*y_4 + u.^4.*y_6 + 24.*u.^5.*y_5 - 5.*u.^5.*y_6))./(648.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^3) - (25.*(6.*u - 1).*((x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).*(y_2 - 12.*u.*y_2 + 4.*u.*y_3 + 36.*u.^2.*y_2 - 24.*u.^2.*y_3 - 40.*u.^3.*y_2 + 6.*u.^2.*y_4 + 40.*u.^3.*y_3 + 15.*u.^4.*y_2 - 20.*u.^3.*y_4 - 20.*u.^4.*y_3 + 4.*u.^3.*y_5 + 15.*u.^4.*y_4 - 6.*u.^4.*y_5 + u.^4.*y_6) + (u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).*(x_2 - 2.*x_1 + 12.*u.*x_1 - 12.*u.*x_2 + 4.*u.*x_3 - 24.*u.^2.*x_1 + 36.*u.^2.*x_2 + 20.*u.^3.*x_1 - 24.*u.^2.*x_3 - 40.*u.^3.*x_2 - 6.*u.^4.*x_1 + 6.*u.^2.*x_4 + 40.*u.^3.*x_3 + 15.*u.^4.*x_2 - 20.*u.^3.*x_4 - 20.*u.^4.*x_3 + 4.*u.^3.*x_5 + 15.*u.^4.*x_4 - 6.*u.^4.*x_5 + u.^4.*x_6)).^2.*(u - 1).^4.*(x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2))./(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^4);
    
    ben2 = @(u)  (125.*u.*(3.*u - 1).*((x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).*(y_2 - 12.*u.*y_2 + 4.*u.*y_3 + 36.*u.^2.*y_2 - 24.*u.^2.*y_3 - 40.*u.^3.*y_2 + 6.*u.^2.*y_4 + 40.*u.^3.*y_3 + 15.*u.^4.*y_2 - 20.*u.^3.*y_4 - 20.*u.^4.*y_3 + 4.*u.^3.*y_5 + 15.*u.^4.*y_4 - 6.*u.^4.*y_5 + u.^4.*y_6) + (u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).*(x_2 - 2.*x_1 + 12.*u.*x_1 - 12.*u.*x_2 + 4.*u.*x_3 - 24.*u.^2.*x_1 + 36.*u.^2.*x_2 + 20.*u.^3.*x_1 - 24.*u.^2.*x_3 - 40.*u.^3.*x_2 - 6.*u.^4.*x_1 + 6.*u.^2.*x_4 + 40.*u.^3.*x_3 + 15.*u.^4.*x_2 - 20.*u.^3.*x_4 - 20.*u.^4.*x_3 + 4.*u.^3.*x_5 + 15.*u.^4.*x_4 - 6.*u.^4.*x_5 + u.^4.*x_6)).^2.*(u - 1).^3.*(x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2))./(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^4) - (5.*u.^2.*(u - 1).^2.*((6.*u.^5.*y_6 - 6.*u.^5.*y_5 + 30.*u.*y_2.*(u - 1).^4 - 30.*u.^4.*y_5.*(u - 1) + 15.*u.^4.*y_4.*(2.*u - 2) + 60.*u.^2.*y_2.*(u - 1).^3 - 60.*u.^2.*y_3.*(u - 1).^3 - 60.*u.^3.*y_3.*(u - 1).^2 + 60.*u.^3.*y_4.*(u - 1).^2).*(30.*x_2 - 60.*x_1 + 360.*u.*x_1 - 360.*u.*x_2 + 120.*u.*x_3 - 720.*u.^2.*x_1 + 1080.*u.^2.*x_2 + 600.*u.^3.*x_1 - 720.*u.^2.*x_3 - 1200.*u.^3.*x_2 - 180.*u.^4.*x_1 + 180.*u.^2.*x_4 + 1200.*u.^3.*x_3 + 450.*u.^4.*x_2 - 600.*u.^3.*x_4 - 600.*u.^4.*x_3 + 120.*u.^3.*x_5 + 450.*u.^4.*x_4 - 180.*u.^4.*x_5 + 30.*u.^4.*x_6) + (6.*x_1.*(u - 1).^5 + 6.*u.^5.*x_5 - 6.*u.^5.*x_6 + 30.*u.*x_1.*(u - 1).^4 - 30.*u.*x_2.*(u - 1).^4 + 30.*u.^4.*x_5.*(u - 1) - 15.*u.^4.*x_4.*(2.*u - 2) - 60.*u.^2.*x_2.*(u - 1).^3 + 60.*u.^2.*x_3.*(u - 1).^3 + 60.*u.^3.*x_3.*(u - 1).^2 - 60.*u.^3.*x_4.*(u - 1).^2).*(30.*y_2 - 360.*u.*y_2 + 120.*u.*y_3 + 1080.*u.^2.*y_2 - 720.*u.^2.*y_3 - 1200.*u.^3.*y_2 + 180.*u.^2.*y_4 + 1200.*u.^3.*y_3 + 450.*u.^4.*y_2 - 600.*u.^3.*y_4 - 600.*u.^4.*y_3 + 120.*u.^3.*y_5 + 450.*u.^4.*y_4 - 180.*u.^4.*y_5 + 30.*u.^4.*y_6)).*(10.*y_3 - 60.*u.*y_3 + 20.*u.*y_4 + 140.*u.^2.*y_3 - 95.*u.^2.*y_4 - 140.*u.^3.*y_3 + 15.*u.^2.*y_5 + 150.*u.^3.*y_4 + 50.*u.^4.*y_3 - 54.*u.^3.*y_5 - 75.*u.^4.*y_4 + 4.*u.^3.*y_6 + 45.*u.^4.*y_5 - 10.*u.^4.*y_6))./(648.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^3);
    
    ben3 = @(u) (5.*(u - 1).^2.*((6.*u.^5.*y_6 - 6.*u.^5.*y_5 + 30.*u.*y_2.*(u - 1).^4 - 30.*u.^4.*y_5.*(u - 1) + 15.*u.^4.*y_4.*(2.*u - 2) + 60.*u.^2.*y_2.*(u - 1).^3 - 60.*u.^2.*y_3.*(u - 1).^3 - 60.*u.^3.*y_3.*(u - 1).^2 + 60.*u.^3.*y_4.*(u - 1).^2).*(30.*x_2 - 60.*x_1 + 360.*u.*x_1 - 360.*u.*x_2 + 120.*u.*x_3 - 720.*u.^2.*x_1 + 1080.*u.^2.*x_2 + 600.*u.^3.*x_1 - 720.*u.^2.*x_3 - 1200.*u.^3.*x_2 - 180.*u.^4.*x_1 + 180.*u.^2.*x_4 + 1200.*u.^3.*x_3 + 450.*u.^4.*x_2 - 600.*u.^3.*x_4 - 600.*u.^4.*x_3 + 120.*u.^3.*x_5 + 450.*u.^4.*x_4 - 180.*u.^4.*x_5 + 30.*u.^4.*x_6) + (6.*x_1.*(u - 1).^5 + 6.*u.^5.*x_5 - 6.*u.^5.*x_6 + 30.*u.*x_1.*(u - 1).^4 - 30.*u.*x_2.*(u - 1).^4 + 30.*u.^4.*x_5.*(u - 1) - 15.*u.^4.*x_4.*(2.*u - 2) - 60.*u.^2.*x_2.*(u - 1).^3 + 60.*u.^2.*x_3.*(u - 1).^3 + 60.*u.^3.*x_3.*(u - 1).^2 - 60.*u.^3.*x_4.*(u - 1).^2).*(30.*y_2 - 360.*u.*y_2 + 120.*u.*y_3 + 1080.*u.^2.*y_2 - 720.*u.^2.*y_3 - 1200.*u.^3.*y_2 + 180.*u.^2.*y_4 + 1200.*u.^3.*y_3 + 450.*u.^4.*y_2 - 600.*u.^3.*y_4 - 600.*u.^4.*y_3 + 120.*u.^3.*y_5 + 450.*u.^4.*y_4 - 180.*u.^4.*y_5 + 30.*u.^4.*y_6)).*(10.*u.*x_1 - x_1 - 45.*u.^2.*x_1 + 100.*u.^3.*x_1 + 10.*u.^2.*x_3 - 115.*u.^4.*x_1 - 60.*u.^3.*x_3 + 66.*u.^5.*x_1 + 20.*u.^3.*x_4 + 140.*u.^4.*x_3 - 15.*u.^6.*x_1 - 95.*u.^4.*x_4 - 140.*u.^5.*x_3 + 15.*u.^4.*x_5 + 150.*u.^5.*x_4 + 50.*u.^6.*x_3 - 54.*u.^5.*x_5 - 75.*u.^6.*x_4 + 4.*u.^5.*x_6 + 45.*u.^6.*x_5 - 10.*u.^6.*x_6))./(648.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^3) - (125.*u.*(3.*u - 1).*((x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).*(y_2 - 12.*u.*y_2 + 4.*u.*y_3 + 36.*u.^2.*y_2 - 24.*u.^2.*y_3 - 40.*u.^3.*y_2 + 6.*u.^2.*y_4 + 40.*u.^3.*y_3 + 15.*u.^4.*y_2 - 20.*u.^3.*y_4 - 20.*u.^4.*y_3 + 4.*u.^3.*y_5 + 15.*u.^4.*y_4 - 6.*u.^4.*y_5 + u.^4.*y_6) + (u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).*(x_2 - 2.*x_1 + 12.*u.*x_1 - 12.*u.*x_2 + 4.*u.*x_3 - 24.*u.^2.*x_1 + 36.*u.^2.*x_2 + 20.*u.^3.*x_1 - 24.*u.^2.*x_3 - 40.*u.^3.*x_2 - 6.*u.^4.*x_1 + 6.*u.^2.*x_4 + 40.*u.^3.*x_3 + 15.*u.^4.*x_2 - 20.*u.^3.*x_4 - 20.*u.^4.*x_3 + 4.*u.^3.*x_5 + 15.*u.^4.*x_4 - 6.*u.^4.*x_5 + u.^4.*x_6)).^2.*(u - 1).^3.*(u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2))./(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^4);

    ben4 = @(u) (5.*u.^2.*(u - 1).*((6.*u.^5.*y_6 - 6.*u.^5.*y_5 + 30.*u.*y_2.*(u - 1).^4 - 30.*u.^4.*y_5.*(u - 1) + 15.*u.^4.*y_4.*(2.*u - 2) + 60.*u.^2.*y_2.*(u - 1).^3 - 60.*u.^2.*y_3.*(u - 1).^3 - 60.*u.^3.*y_3.*(u - 1).^2 + 60.*u.^3.*y_4.*(u - 1).^2).*(30.*x_2 - 60.*x_1 + 360.*u.*x_1 - 360.*u.*x_2 + 120.*u.*x_3 - 720.*u.^2.*x_1 + 1080.*u.^2.*x_2 + 600.*u.^3.*x_1 - 720.*u.^2.*x_3 - 1200.*u.^3.*x_2 - 180.*u.^4.*x_1 + 180.*u.^2.*x_4 + 1200.*u.^3.*x_3 + 450.*u.^4.*x_2 - 600.*u.^3.*x_4 - 600.*u.^4.*x_3 + 120.*u.^3.*x_5 + 450.*u.^4.*x_4 - 180.*u.^4.*x_5 + 30.*u.^4.*x_6) + (6.*x_1.*(u - 1).^5 + 6.*u.^5.*x_5 - 6.*u.^5.*x_6 + 30.*u.*x_1.*(u - 1).^4 - 30.*u.*x_2.*(u - 1).^4 + 30.*u.^4.*x_5.*(u - 1) - 15.*u.^4.*x_4.*(2.*u - 2) - 60.*u.^2.*x_2.*(u - 1).^3 + 60.*u.^2.*x_3.*(u - 1).^3 + 60.*u.^3.*x_3.*(u - 1).^2 - 60.*u.^3.*x_4.*(u - 1).^2).*(30.*y_2 - 360.*u.*y_2 + 120.*u.*y_3 + 1080.*u.^2.*y_2 - 720.*u.^2.*y_3 - 1200.*u.^3.*y_2 + 180.*u.^2.*y_4 + 1200.*u.^3.*y_3 + 450.*u.^4.*y_2 - 600.*u.^3.*y_4 - 600.*u.^4.*y_3 + 120.*u.^3.*y_5 + 450.*u.^4.*y_4 - 180.*u.^4.*y_5 + 30.*u.^4.*y_6)).*(35.*u.*y_2 - 5.*y_2 - 100.*u.^2.*y_2 + 140.*u.^3.*y_2 + 10.*u.^2.*y_4 - 95.*u.^4.*y_2 - 40.*u.^3.*y_4 + 25.*u.^5.*y_2 + 10.*u.^3.*y_5 + 55.*u.^4.*y_4 - 28.*u.^4.*y_5 - 25.*u.^5.*y_4 + 3.*u.^4.*y_6 + 20.*u.^5.*y_5 - 5.*u.^5.*y_6))./(324.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^3) - (125.*u.^2.*(2.*u - 1).*((x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).*(y_2 - 12.*u.*y_2 + 4.*u.*y_3 + 36.*u.^2.*y_2 - 24.*u.^2.*y_3 - 40.*u.^3.*y_2 + 6.*u.^2.*y_4 + 40.*u.^3.*y_3 + 15.*u.^4.*y_2 - 20.*u.^3.*y_4 - 20.*u.^4.*y_3 + 4.*u.^3.*y_5 + 15.*u.^4.*y_4 - 6.*u.^4.*y_5 + u.^4.*y_6) + (u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).*(x_2 - 2.*x_1 + 12.*u.*x_1 - 12.*u.*x_2 + 4.*u.*x_3 - 24.*u.^2.*x_1 + 36.*u.^2.*x_2 + 20.*u.^3.*x_1 - 24.*u.^2.*x_3 - 40.*u.^3.*x_2 - 6.*u.^4.*x_1 + 6.*u.^2.*x_4 + 40.*u.^3.*x_3 + 15.*u.^4.*x_2 - 20.*u.^3.*x_4 - 20.*u.^4.*x_3 + 4.*u.^3.*x_5 + 15.*u.^4.*x_4 - 6.*u.^4.*x_5 + u.^4.*x_6)).^2.*(u - 1).^2.*(x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2))./(3.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^4);

    ben5 = @(u) (5.*u.*(u - 1).*((6.*u.^5.*y_6 - 6.*u.^5.*y_5 + 30.*u.*y_2.*(u - 1).^4 - 30.*u.^4.*y_5.*(u - 1) + 15.*u.^4.*y_4.*(2.*u - 2) + 60.*u.^2.*y_2.*(u - 1).^3 - 60.*u.^2.*y_3.*(u - 1).^3 - 60.*u.^3.*y_3.*(u - 1).^2 + 60.*u.^3.*y_4.*(u - 1).^2).*(30.*x_2 - 60.*x_1 + 360.*u.*x_1 - 360.*u.*x_2 + 120.*u.*x_3 - 720.*u.^2.*x_1 + 1080.*u.^2.*x_2 + 600.*u.^3.*x_1 - 720.*u.^2.*x_3 - 1200.*u.^3.*x_2 - 180.*u.^4.*x_1 + 180.*u.^2.*x_4 + 1200.*u.^3.*x_3 + 450.*u.^4.*x_2 - 600.*u.^3.*x_4 - 600.*u.^4.*x_3 + 120.*u.^3.*x_5 + 450.*u.^4.*x_4 - 180.*u.^4.*x_5 + 30.*u.^4.*x_6) + (6.*x_1.*(u - 1).^5 + 6.*u.^5.*x_5 - 6.*u.^5.*x_6 + 30.*u.*x_1.*(u - 1).^4 - 30.*u.*x_2.*(u - 1).^4 + 30.*u.^4.*x_5.*(u - 1) - 15.*u.^4.*x_4.*(2.*u - 2) - 60.*u.^2.*x_2.*(u - 1).^3 + 60.*u.^2.*x_3.*(u - 1).^3 + 60.*u.^3.*x_3.*(u - 1).^2 - 60.*u.^3.*x_4.*(u - 1).^2).*(30.*y_2 - 360.*u.*y_2 + 120.*u.*y_3 + 1080.*u.^2.*y_2 - 720.*u.^2.*y_3 - 1200.*u.^3.*y_2 + 180.*u.^2.*y_4 + 1200.*u.^3.*y_3 + 450.*u.^4.*y_2 - 600.*u.^3.*y_4 - 600.*u.^4.*y_3 + 120.*u.^3.*y_5 + 450.*u.^4.*y_4 - 180.*u.^4.*y_5 + 30.*u.^4.*y_6)).*(2.*x_1 - 20.*u.*x_1 + 5.*u.*x_2 + 80.*u.^2.*x_1 - 35.*u.^2.*x_2 - 160.*u.^3.*x_1 + 100.*u.^3.*x_2 + 170.*u.^4.*x_1 - 140.*u.^4.*x_2 - 92.*u.^5.*x_1 - 10.*u.^3.*x_4 + 95.*u.^5.*x_2 + 20.*u.^6.*x_1 + 40.*u.^4.*x_4 - 25.*u.^6.*x_2 - 10.*u.^4.*x_5 - 55.*u.^5.*x_4 + 28.*u.^5.*x_5 + 25.*u.^6.*x_4 - 3.*u.^5.*x_6 - 20.*u.^6.*x_5 + 5.*u.^6.*x_6))./(324.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^3) + (125.*u.^2.*(2.*u - 1).*((x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).*(y_2 - 12.*u.*y_2 + 4.*u.*y_3 + 36.*u.^2.*y_2 - 24.*u.^2.*y_3 - 40.*u.^3.*y_2 + 6.*u.^2.*y_4 + 40.*u.^3.*y_3 + 15.*u.^4.*y_2 - 20.*u.^3.*y_4 - 20.*u.^4.*y_3 + 4.*u.^3.*y_5 + 15.*u.^4.*y_4 - 6.*u.^4.*y_5 + u.^4.*y_6) + (u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).*(x_2 - 2.*x_1 + 12.*u.*x_1 - 12.*u.*x_2 + 4.*u.*x_3 - 24.*u.^2.*x_1 + 36.*u.^2.*x_2 + 20.*u.^3.*x_1 - 24.*u.^2.*x_3 - 40.*u.^3.*x_2 - 6.*u.^4.*x_1 + 6.*u.^2.*x_4 + 40.*u.^3.*x_3 + 15.*u.^4.*x_2 - 20.*u.^3.*x_4 - 20.*u.^4.*x_3 + 4.*u.^3.*x_5 + 15.*u.^4.*x_4 - 6.*u.^4.*x_5 + u.^4.*x_6)).^2.*(u - 1).^2.*(u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2))./(3.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^4);

    ben6 = @(u) (5.*u.^3.*((6.*u.^5.*y_6 - 6.*u.^5.*y_5 + 30.*u.*y_2.*(u - 1).^4 - 30.*u.^4.*y_5.*(u - 1) + 15.*u.^4.*y_4.*(2.*u - 2) + 60.*u.^2.*y_2.*(u - 1).^3 - 60.*u.^2.*y_3.*(u - 1).^3 - 60.*u.^3.*y_3.*(u - 1).^2 + 60.*u.^3.*y_4.*(u - 1).^2).*(30.*x_2 - 60.*x_1 + 360.*u.*x_1 - 360.*u.*x_2 + 120.*u.*x_3 - 720.*u.^2.*x_1 + 1080.*u.^2.*x_2 + 600.*u.^3.*x_1 - 720.*u.^2.*x_3 - 1200.*u.^3.*x_2 - 180.*u.^4.*x_1 + 180.*u.^2.*x_4 + 1200.*u.^3.*x_3 + 450.*u.^4.*x_2 - 600.*u.^3.*x_4 - 600.*u.^4.*x_3 + 120.*u.^3.*x_5 + 450.*u.^4.*x_4 - 180.*u.^4.*x_5 + 30.*u.^4.*x_6) + (6.*x_1.*(u - 1).^5 + 6.*u.^5.*x_5 - 6.*u.^5.*x_6 + 30.*u.*x_1.*(u - 1).^4 - 30.*u.*x_2.*(u - 1).^4 + 30.*u.^4.*x_5.*(u - 1) - 15.*u.^4.*x_4.*(2.*u - 2) - 60.*u.^2.*x_2.*(u - 1).^3 + 60.*u.^2.*x_3.*(u - 1).^3 + 60.*u.^3.*x_3.*(u - 1).^2 - 60.*u.^3.*x_4.*(u - 1).^2).*(30.*y_2 - 360.*u.*y_2 + 120.*u.*y_3 + 1080.*u.^2.*y_2 - 720.*u.^2.*y_3 - 1200.*u.^3.*y_2 + 180.*u.^2.*y_4 + 1200.*u.^3.*y_3 + 450.*u.^4.*y_2 - 600.*u.^3.*y_4 - 600.*u.^4.*y_3 + 120.*u.^3.*y_5 + 450.*u.^4.*y_4 - 180.*u.^4.*y_5 + 30.*u.^4.*y_6)).*(20.*y_2 - 135.*u.*y_2 + 20.*u.*y_3 + 360.*u.^2.*y_2 - 100.*u.^2.*y_3 - 470.*u.^3.*y_2 + 190.*u.^3.*y_3 + 300.*u.^4.*y_2 - 160.*u.^4.*y_3 - 75.*u.^5.*y_2 - 10.*u.^3.*y_5 + 50.*u.^5.*y_3 + 24.*u.^4.*y_5 - 4.*u.^4.*y_6 - 15.*u.^5.*y_5 + 5.*u.^5.*y_6))./(648.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^3) + (125.*u.^3.*((x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).*(y_2 - 12.*u.*y_2 + 4.*u.*y_3 + 36.*u.^2.*y_2 - 24.*u.^2.*y_3 - 40.*u.^3.*y_2 + 6.*u.^2.*y_4 + 40.*u.^3.*y_3 + 15.*u.^4.*y_2 - 20.*u.^3.*y_4 - 20.*u.^4.*y_3 + 4.*u.^3.*y_5 + 15.*u.^4.*y_4 - 6.*u.^4.*y_5 + u.^4.*y_6) + (u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).*(x_2 - 2.*x_1 + 12.*u.*x_1 - 12.*u.*x_2 + 4.*u.*x_3 - 24.*u.^2.*x_1 + 36.*u.^2.*x_2 + 20.*u.^3.*x_1 - 24.*u.^2.*x_3 - 40.*u.^3.*x_2 - 6.*u.^4.*x_1 + 6.*u.^2.*x_4 + 40.*u.^3.*x_3 + 15.*u.^4.*x_2 - 20.*u.^3.*x_4 - 20.*u.^4.*x_3 + 4.*u.^3.*x_5 + 15.*u.^4.*x_4 - 6.*u.^4.*x_5 + u.^4.*x_6)).^2.*(3.*u.^2 - 5.*u + 2).*(x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2))./(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^4);

    ben7 = @(u) - (5.*u.^2.*((6.*u.^5.*y_6 - 6.*u.^5.*y_5 + 30.*u.*y_2.*(u - 1).^4 - 30.*u.^4.*y_5.*(u - 1) + 15.*u.^4.*y_4.*(2.*u - 2) + 60.*u.^2.*y_2.*(u - 1).^3 - 60.*u.^2.*y_3.*(u - 1).^3 - 60.*u.^3.*y_3.*(u - 1).^2 + 60.*u.^3.*y_4.*(u - 1).^2).*(30.*x_2 - 60.*x_1 + 360.*u.*x_1 - 360.*u.*x_2 + 120.*u.*x_3 - 720.*u.^2.*x_1 + 1080.*u.^2.*x_2 + 600.*u.^3.*x_1 - 720.*u.^2.*x_3 - 1200.*u.^3.*x_2 - 180.*u.^4.*x_1 + 180.*u.^2.*x_4 + 1200.*u.^3.*x_3 + 450.*u.^4.*x_2 - 600.*u.^3.*x_4 - 600.*u.^4.*x_3 + 120.*u.^3.*x_5 + 450.*u.^4.*x_4 - 180.*u.^4.*x_5 + 30.*u.^4.*x_6) + (6.*x_1.*(u - 1).^5 + 6.*u.^5.*x_5 - 6.*u.^5.*x_6 + 30.*u.*x_1.*(u - 1).^4 - 30.*u.*x_2.*(u - 1).^4 + 30.*u.^4.*x_5.*(u - 1) - 15.*u.^4.*x_4.*(2.*u - 2) - 60.*u.^2.*x_2.*(u - 1).^3 + 60.*u.^2.*x_3.*(u - 1).^3 + 60.*u.^3.*x_3.*(u - 1).^2 - 60.*u.^3.*x_4.*(u - 1).^2).*(30.*y_2 - 360.*u.*y_2 + 120.*u.*y_3 + 1080.*u.^2.*y_2 - 720.*u.^2.*y_3 - 1200.*u.^3.*y_2 + 180.*u.^2.*y_4 + 1200.*u.^3.*y_3 + 450.*u.^4.*y_2 - 600.*u.^3.*y_4 - 600.*u.^4.*y_3 + 120.*u.^3.*y_5 + 450.*u.^4.*y_4 - 180.*u.^4.*y_5 + 30.*u.^4.*y_6)).*(6.*x_1 - 60.*u.*x_1 + 20.*u.*x_2 + 225.*u.^2.*x_1 - 135.*u.^2.*x_2 - 420.*u.^3.*x_1 + 20.*u.^2.*x_3 + 360.*u.^3.*x_2 + 420.*u.^4.*x_1 - 100.*u.^3.*x_3 - 470.*u.^4.*x_2 - 216.*u.^5.*x_1 + 190.*u.^4.*x_3 + 300.*u.^5.*x_2 + 45.*u.^6.*x_1 - 160.*u.^5.*x_3 - 75.*u.^6.*x_2 - 10.*u.^4.*x_5 + 50.*u.^6.*x_3 + 24.*u.^5.*x_5 - 4.*u.^5.*x_6 - 15.*u.^6.*x_5 + 5.*u.^6.*x_6))./(648.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^3) - (125.*u.^3.*((x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).*(y_2 - 12.*u.*y_2 + 4.*u.*y_3 + 36.*u.^2.*y_2 - 24.*u.^2.*y_3 - 40.*u.^3.*y_2 + 6.*u.^2.*y_4 + 40.*u.^3.*y_3 + 15.*u.^4.*y_2 - 20.*u.^3.*y_4 - 20.*u.^4.*y_3 + 4.*u.^3.*y_5 + 15.*u.^4.*y_4 - 6.*u.^4.*y_5 + u.^4.*y_6) + (u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).*(x_2 - 2.*x_1 + 12.*u.*x_1 - 12.*u.*x_2 + 4.*u.*x_3 - 24.*u.^2.*x_1 + 36.*u.^2.*x_2 + 20.*u.^3.*x_1 - 24.*u.^2.*x_3 - 40.*u.^3.*x_2 - 6.*u.^4.*x_1 + 6.*u.^2.*x_4 + 40.*u.^3.*x_3 + 15.*u.^4.*x_2 - 20.*u.^3.*x_4 - 20.*u.^4.*x_3 + 4.*u.^3.*x_5 + 15.*u.^4.*x_4 - 6.*u.^4.*x_5 + u.^4.*x_6)).^2.*(3.*u.^2 - 5.*u + 2).*(u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2))./(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^4);

    ben8 = @(u) (5.*u.^4.*((6.*u.^5.*y_6 - 6.*u.^5.*y_5 + 30.*u.*y_2.*(u - 1).^4 - 30.*u.^4.*y_5.*(u - 1) + 15.*u.^4.*y_4.*(2.*u - 2) + 60.*u.^2.*y_2.*(u - 1).^3 - 60.*u.^2.*y_3.*(u - 1).^3 - 60.*u.^3.*y_3.*(u - 1).^2 + 60.*u.^3.*y_4.*(u - 1).^2).*(30.*x_2 - 60.*x_1 + 360.*u.*x_1 - 360.*u.*x_2 + 120.*u.*x_3 - 720.*u.^2.*x_1 + 1080.*u.^2.*x_2 + 600.*u.^3.*x_1 - 720.*u.^2.*x_3 - 1200.*u.^3.*x_2 - 180.*u.^4.*x_1 + 180.*u.^2.*x_4 + 1200.*u.^3.*x_3 + 450.*u.^4.*x_2 - 600.*u.^3.*x_4 - 600.*u.^4.*x_3 + 120.*u.^3.*x_5 + 450.*u.^4.*x_4 - 180.*u.^4.*x_5 + 30.*u.^4.*x_6) + (6.*x_1.*(u - 1).^5 + 6.*u.^5.*x_5 - 6.*u.^5.*x_6 + 30.*u.*x_1.*(u - 1).^4 - 30.*u.*x_2.*(u - 1).^4 + 30.*u.^4.*x_5.*(u - 1) - 15.*u.^4.*x_4.*(2.*u - 2) - 60.*u.^2.*x_2.*(u - 1).^3 + 60.*u.^2.*x_3.*(u - 1).^3 + 60.*u.^3.*x_3.*(u - 1).^2 - 60.*u.^3.*x_4.*(u - 1).^2).*(30.*y_2 - 360.*u.*y_2 + 120.*u.*y_3 + 1080.*u.^2.*y_2 - 720.*u.^2.*y_3 - 1200.*u.^3.*y_2 + 180.*u.^2.*y_4 + 1200.*u.^3.*y_3 + 450.*u.^4.*y_2 - 600.*u.^3.*y_4 - 600.*u.^4.*y_3 + 120.*u.^3.*y_5 + 450.*u.^4.*y_4 - 180.*u.^4.*y_5 + 30.*u.^4.*y_6)).*(15.*y_2 - 84.*u.*y_2 + 20.*u.*y_3 + 168.*u.^2.*y_2 - 76.*u.^2.*y_3 - 144.*u.^3.*y_2 + 10.*u.^2.*y_4 + 96.*u.^3.*y_3 + 45.*u.^4.*y_2 - 24.*u.^3.*y_4 - 40.*u.^4.*y_3 + 15.*u.^4.*y_4 - u.^4.*y_6))./(648.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^3) - (25.*u.^4.*(6.*u - 5).*((x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).*(y_2 - 12.*u.*y_2 + 4.*u.*y_3 + 36.*u.^2.*y_2 - 24.*u.^2.*y_3 - 40.*u.^3.*y_2 + 6.*u.^2.*y_4 + 40.*u.^3.*y_3 + 15.*u.^4.*y_2 - 20.*u.^3.*y_4 - 20.*u.^4.*y_3 + 4.*u.^3.*y_5 + 15.*u.^4.*y_4 - 6.*u.^4.*y_5 + u.^4.*y_6) + (u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).*(x_2 - 2.*x_1 + 12.*u.*x_1 - 12.*u.*x_2 + 4.*u.*x_3 - 24.*u.^2.*x_1 + 36.*u.^2.*x_2 + 20.*u.^3.*x_1 - 24.*u.^2.*x_3 - 40.*u.^3.*x_2 - 6.*u.^4.*x_1 + 6.*u.^2.*x_4 + 40.*u.^3.*x_3 + 15.*u.^4.*x_2 - 20.*u.^3.*x_4 - 20.*u.^4.*x_3 + 4.*u.^3.*x_5 + 15.*u.^4.*x_4 - 6.*u.^4.*x_5 + u.^4.*x_6)).^2.*(x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2))./(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^4);

    ben9 = @(u) (25.*u.^4.*(6.*u - 5).*((x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).*(y_2 - 12.*u.*y_2 + 4.*u.*y_3 + 36.*u.^2.*y_2 - 24.*u.^2.*y_3 - 40.*u.^3.*y_2 + 6.*u.^2.*y_4 + 40.*u.^3.*y_3 + 15.*u.^4.*y_2 - 20.*u.^3.*y_4 - 20.*u.^4.*y_3 + 4.*u.^3.*y_5 + 15.*u.^4.*y_4 - 6.*u.^4.*y_5 + u.^4.*y_6) + (u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).*(x_2 - 2.*x_1 + 12.*u.*x_1 - 12.*u.*x_2 + 4.*u.*x_3 - 24.*u.^2.*x_1 + 36.*u.^2.*x_2 + 20.*u.^3.*x_1 - 24.*u.^2.*x_3 - 40.*u.^3.*x_2 - 6.*u.^4.*x_1 + 6.*u.^2.*x_4 + 40.*u.^3.*x_3 + 15.*u.^4.*x_2 - 20.*u.^3.*x_4 - 20.*u.^4.*x_3 + 4.*u.^3.*x_5 + 15.*u.^4.*x_4 - 6.*u.^4.*x_5 + u.^4.*x_6)).^2.*(u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2))./(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^4) - (5.*u.^3.*((6.*u.^5.*y_6 - 6.*u.^5.*y_5 + 30.*u.*y_2.*(u - 1).^4 - 30.*u.^4.*y_5.*(u - 1) + 15.*u.^4.*y_4.*(2.*u - 2) + 60.*u.^2.*y_2.*(u - 1).^3 - 60.*u.^2.*y_3.*(u - 1).^3 - 60.*u.^3.*y_3.*(u - 1).^2 + 60.*u.^3.*y_4.*(u - 1).^2).*(30.*x_2 - 60.*x_1 + 360.*u.*x_1 - 360.*u.*x_2 + 120.*u.*x_3 - 720.*u.^2.*x_1 + 1080.*u.^2.*x_2 + 600.*u.^3.*x_1 - 720.*u.^2.*x_3 - 1200.*u.^3.*x_2 - 180.*u.^4.*x_1 + 180.*u.^2.*x_4 + 1200.*u.^3.*x_3 + 450.*u.^4.*x_2 - 600.*u.^3.*x_4 - 600.*u.^4.*x_3 + 120.*u.^3.*x_5 + 450.*u.^4.*x_4 - 180.*u.^4.*x_5 + 30.*u.^4.*x_6) + (6.*x_1.*(u - 1).^5 + 6.*u.^5.*x_5 - 6.*u.^5.*x_6 + 30.*u.*x_1.*(u - 1).^4 - 30.*u.*x_2.*(u - 1).^4 + 30.*u.^4.*x_5.*(u - 1) - 15.*u.^4.*x_4.*(2.*u - 2) - 60.*u.^2.*x_2.*(u - 1).^3 + 60.*u.^2.*x_3.*(u - 1).^3 + 60.*u.^3.*x_3.*(u - 1).^2 - 60.*u.^3.*x_4.*(u - 1).^2).*(30.*y_2 - 360.*u.*y_2 + 120.*u.*y_3 + 1080.*u.^2.*y_2 - 720.*u.^2.*y_3 - 1200.*u.^3.*y_2 + 180.*u.^2.*y_4 + 1200.*u.^3.*y_3 + 450.*u.^4.*y_2 - 600.*u.^3.*y_4 - 600.*u.^4.*y_3 + 120.*u.^3.*y_5 + 450.*u.^4.*y_4 - 180.*u.^4.*y_5 + 30.*u.^4.*y_6)).*(4.*x_1 - 36.*u.*x_1 + 15.*u.*x_2 + 108.*u.^2.*x_1 - 84.*u.^2.*x_2 - 148.*u.^3.*x_1 + 20.*u.^2.*x_3 + 168.*u.^3.*x_2 + 96.*u.^4.*x_1 - 76.*u.^3.*x_3 - 144.*u.^4.*x_2 - 24.*u.^5.*x_1 + 10.*u.^3.*x_4 + 96.*u.^4.*x_3 + 45.*u.^5.*x_2 - 24.*u.^4.*x_4 - 40.*u.^5.*x_3 + 15.*u.^5.*x_4 - u.^5.*x_6))./(648.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^3);

    ben10 = @(u) (5.*u.^5.*((6.*u.^5.*y_6 - 6.*u.^5.*y_5 + 30.*u.*y_2.*(u - 1).^4 - 30.*u.^4.*y_5.*(u - 1) + 15.*u.^4.*y_4.*(2.*u - 2) + 60.*u.^2.*y_2.*(u - 1).^3 - 60.*u.^2.*y_3.*(u - 1).^3 - 60.*u.^3.*y_3.*(u - 1).^2 + 60.*u.^3.*y_4.*(u - 1).^2).*(30.*x_2 - 60.*x_1 + 360.*u.*x_1 - 360.*u.*x_2 + 120.*u.*x_3 - 720.*u.^2.*x_1 + 1080.*u.^2.*x_2 + 600.*u.^3.*x_1 - 720.*u.^2.*x_3 - 1200.*u.^3.*x_2 - 180.*u.^4.*x_1 + 180.*u.^2.*x_4 + 1200.*u.^3.*x_3 + 450.*u.^4.*x_2 - 600.*u.^3.*x_4 - 600.*u.^4.*x_3 + 120.*u.^3.*x_5 + 450.*u.^4.*x_4 - 180.*u.^4.*x_5 + 30.*u.^4.*x_6) + (6.*x_1.*(u - 1).^5 + 6.*u.^5.*x_5 - 6.*u.^5.*x_6 + 30.*u.*x_1.*(u - 1).^4 - 30.*u.*x_2.*(u - 1).^4 + 30.*u.^4.*x_5.*(u - 1) - 15.*u.^4.*x_4.*(2.*u - 2) - 60.*u.^2.*x_2.*(u - 1).^3 + 60.*u.^2.*x_3.*(u - 1).^3 + 60.*u.^3.*x_3.*(u - 1).^2 - 60.*u.^3.*x_4.*(u - 1).^2).*(30.*y_2 - 360.*u.*y_2 + 120.*u.*y_3 + 1080.*u.^2.*y_2 - 720.*u.^2.*y_3 - 1200.*u.^3.*y_2 + 180.*u.^2.*y_4 + 1200.*u.^3.*y_3 + 450.*u.^4.*y_2 - 600.*u.^3.*y_4 - 600.*u.^4.*y_3 + 120.*u.^3.*y_5 + 450.*u.^4.*y_4 - 180.*u.^4.*y_5 + 30.*u.^4.*y_6)).*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5))./(648.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^3) + (25.*u.^5.*((x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).*(y_2 - 12.*u.*y_2 + 4.*u.*y_3 + 36.*u.^2.*y_2 - 24.*u.^2.*y_3 - 40.*u.^3.*y_2 + 6.*u.^2.*y_4 + 40.*u.^3.*y_3 + 15.*u.^4.*y_2 - 20.*u.^3.*y_4 - 20.*u.^4.*y_3 + 4.*u.^3.*y_5 + 15.*u.^4.*y_4 - 6.*u.^4.*y_5 + u.^4.*y_6) + (u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).*(x_2 - 2.*x_1 + 12.*u.*x_1 - 12.*u.*x_2 + 4.*u.*x_3 - 24.*u.^2.*x_1 + 36.*u.^2.*x_2 + 20.*u.^3.*x_1 - 24.*u.^2.*x_3 - 40.*u.^3.*x_2 - 6.*u.^4.*x_1 + 6.*u.^2.*x_4 + 40.*u.^3.*x_3 + 15.*u.^4.*x_2 - 20.*u.^3.*x_4 - 20.*u.^4.*x_3 + 4.*u.^3.*x_5 + 15.*u.^4.*x_4 - 6.*u.^4.*x_5 + u.^4.*x_6)).^2.*(x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2))./(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^4);

    ben11 = @(u) - (5.*u.^4.*((6.*u.^5.*y_6 - 6.*u.^5.*y_5 + 30.*u.*y_2.*(u - 1).^4 - 30.*u.^4.*y_5.*(u - 1) + 15.*u.^4.*y_4.*(2.*u - 2) + 60.*u.^2.*y_2.*(u - 1).^3 - 60.*u.^2.*y_3.*(u - 1).^3 - 60.*u.^3.*y_3.*(u - 1).^2 + 60.*u.^3.*y_4.*(u - 1).^2).*(30.*x_2 - 60.*x_1 + 360.*u.*x_1 - 360.*u.*x_2 + 120.*u.*x_3 - 720.*u.^2.*x_1 + 1080.*u.^2.*x_2 + 600.*u.^3.*x_1 - 720.*u.^2.*x_3 - 1200.*u.^3.*x_2 - 180.*u.^4.*x_1 + 180.*u.^2.*x_4 + 1200.*u.^3.*x_3 + 450.*u.^4.*x_2 - 600.*u.^3.*x_4 - 600.*u.^4.*x_3 + 120.*u.^3.*x_5 + 450.*u.^4.*x_4 - 180.*u.^4.*x_5 + 30.*u.^4.*x_6) + (6.*x_1.*(u - 1).^5 + 6.*u.^5.*x_5 - 6.*u.^5.*x_6 + 30.*u.*x_1.*(u - 1).^4 - 30.*u.*x_2.*(u - 1).^4 + 30.*u.^4.*x_5.*(u - 1) - 15.*u.^4.*x_4.*(2.*u - 2) - 60.*u.^2.*x_2.*(u - 1).^3 + 60.*u.^2.*x_3.*(u - 1).^3 + 60.*u.^3.*x_3.*(u - 1).^2 - 60.*u.^3.*x_4.*(u - 1).^2).*(30.*y_2 - 360.*u.*y_2 + 120.*u.*y_3 + 1080.*u.^2.*y_2 - 720.*u.^2.*y_3 - 1200.*u.^3.*y_2 + 180.*u.^2.*y_4 + 1200.*u.^3.*y_3 + 450.*u.^4.*y_2 - 600.*u.^3.*y_4 - 600.*u.^4.*y_3 + 120.*u.^3.*y_5 + 450.*u.^4.*y_4 - 180.*u.^4.*y_5 + 30.*u.^4.*y_6)).*(x_1 - 8.*u.*x_1 + 4.*u.*x_2 + 18.*u.^2.*x_1 - 18.*u.^2.*x_2 - 16.*u.^3.*x_1 + 6.*u.^2.*x_3 + 24.*u.^3.*x_2 + 5.*u.^4.*x_1 - 16.*u.^3.*x_3 - 10.*u.^4.*x_2 + 4.*u.^3.*x_4 + 10.*u.^4.*x_3 - 5.*u.^4.*x_4 + u.^4.*x_5))./(648.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^3) - (25.*u.^5.*((x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).*(y_2 - 12.*u.*y_2 + 4.*u.*y_3 + 36.*u.^2.*y_2 - 24.*u.^2.*y_3 - 40.*u.^3.*y_2 + 6.*u.^2.*y_4 + 40.*u.^3.*y_3 + 15.*u.^4.*y_2 - 20.*u.^3.*y_4 - 20.*u.^4.*y_3 + 4.*u.^3.*y_5 + 15.*u.^4.*y_4 - 6.*u.^4.*y_5 + u.^4.*y_6) + (u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).*(x_2 - 2.*x_1 + 12.*u.*x_1 - 12.*u.*x_2 + 4.*u.*x_3 - 24.*u.^2.*x_1 + 36.*u.^2.*x_2 + 20.*u.^3.*x_1 - 24.*u.^2.*x_3 - 40.*u.^3.*x_2 - 6.*u.^4.*x_1 + 6.*u.^2.*x_4 + 40.*u.^3.*x_3 + 15.*u.^4.*x_2 - 20.*u.^3.*x_4 - 20.*u.^4.*x_3 + 4.*u.^3.*x_5 + 15.*u.^4.*x_4 - 6.*u.^4.*x_5 + u.^4.*x_6)).^2.*(u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2))./(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^4);


   

    str1 = @(u) (12.*(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2) - 1).*(5.*u.*(u - 1).^4 + (u - 1).^5).*(x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2))./((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2);
    str2 = @(u)  -(12.*(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2) - 1).*(5.*u.*(u - 1).^4 + 10.*u.^2.*(u - 1).^3).*(x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2))./((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2);
    str3 = @(u) (12.*(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2) - 1).*(5.*u.*(u - 1).^4 + 10.*u.^2.*(u - 1).^3).*(u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2))./((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2);
    str4 = @(u) (12.*(10.*u.^2.*(u - 1).^3 + 10.*u.^3.*(u - 1).^2).*(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2) - 1).*(x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2))./((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2);
    str5 = @(u) -(12.*(10.*u.^2.*(u - 1).^3 + 10.*u.^3.*(u - 1).^2).*(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2) - 1).*(u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2))./((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2);
    str6 = @(u) -(12.*(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2) - 1).*(5.*u.^4.*(u - 1) + 10.*u.^3.*(u - 1).^2).*(x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2))./((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2);
    str7 = @(u)(12.*(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2) - 1).*(5.*u.^4.*(u - 1) + 10.*u.^3.*(u - 1).^2).*(u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2))./((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2);
    str8 = @(u)(12.*(5.*u.^4.*(u - 1) + u.^5).*(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2) - 1).*(x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2))./((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2);
    str9 = @(u) -(12.*(5.*u.^4.*(u - 1) + u.^5).*(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2) - 1).*(u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2))./((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2);
    str10 = @(u) -(12.*u.^5.*(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2) - 1).*(x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2))./((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2);
    str11 = @(u)(12.*u.^5.*(6.*((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2) - 1).*(u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2))./((u.^5.*y_6 - u.^5.*y_5 + 5.*u.*y_2.*(u - 1).^4 + 5.*u.^4.*y_4.*(u - 1) - 5.*u.^4.*y_5.*(u - 1) + 10.*u.^2.*y_2.*(u - 1).^3 - 10.*u.^2.*y_3.*(u - 1).^3 - 10.*u.^3.*y_3.*(u - 1).^2 + 10.*u.^3.*y_4.*(u - 1).^2).^2 + (x_1.*(u - 1).^5 + u.^5.*x_5 - u.^5.*x_6 + 5.*u.*x_1.*(u - 1).^4 - 5.*u.*x_2.*(u - 1).^4 - 5.*u.^4.*x_4.*(u - 1) + 5.*u.^4.*x_5.*(u - 1) - 10.*u.^2.*x_2.*(u - 1).^3 + 10.*u.^2.*x_3.*(u - 1).^3 + 10.*u.^3.*x_3.*(u - 1).^2 - 10.*u.^3.*x_4.*(u - 1).^2).^2).^(1./2);



    % Using Gaussian quadrature instead of integral function
    Qben1 = (-1/2)*E*I*L*gauss_quad(ben1, 0, 1);
    Qben2 = (-1/2)*E*I*L*gauss_quad(ben2, 0, 1);
    Qben3 = (-1/2)*E*I*L*gauss_quad(ben3, 0, 1);
    Qben4 = (-1/2)*E*I*L*gauss_quad(ben4, 0, 1);
    Qben5 = (-1/2)*E*I*L*gauss_quad(ben5, 0, 1);
    Qben6 = (-1/2)*E*I*L*gauss_quad(ben6, 0, 1);
    Qben7 = (-1/2)*E*I*L*gauss_quad(ben7, 0, 1);
    Qben8 = (-1/2)*E*I*L*gauss_quad(ben8, 0, 1);
    Qben9 = (-1/2)*E*I*L*gauss_quad(ben9, 0, 1);
    Qben10 = (-1/2)*E*I*L*gauss_quad(ben10, 0, 1);
    Qben11 = (-1/2)*E*I*L*gauss_quad(ben11, 0, 1);

    
    Qstr1 = (-1/2) * E * A * L * gauss_quad(str1, 0, 1);
    Qstr2 = (-1/2) * E * A * L * gauss_quad(str2, 0, 1);
    Qstr3 = (-1/2) * E * A * L * gauss_quad(str3, 0, 1);
    Qstr4 = (-1/2) * E * A * L * gauss_quad(str4, 0, 1);
    Qstr5 = (-1/2) * E * A * L * gauss_quad(str5, 0, 1);
    Qstr6 = (-1/2) * E * A * L * gauss_quad(str6, 0, 1);
    Qstr7 = (-1/2) * E * A * L * gauss_quad(str7, 0, 1);
    Qstr8 = (-1/2) * E * A * L * gauss_quad(str8, 0, 1);
    Qstr9 = (-1/2) * E * A * L * gauss_quad(str9, 0, 1);
    Qstr10 = (-1/2) * E * A * L * gauss_quad(str10, 0, 1);
    Qstr11 = (-1/2) * E * A * L * gauss_quad(str11, 0, 1);
    

    % Acceleration equations - using placeholders for the 7-point spline
    x_dotdot1 = (28*(28*Qben1 - 70*Qben2 + 84*Qben4 - 56*Qben6 + 20*Qben8 - 3*Qben10 + 28*Qstr1 - 70*Qstr2 + 84*Qstr4 - 56*Qstr6 + 20*Qstr8 - 3*Qstr10))/(3*l*mu);
    x_dotdot2 =-(28*(350*Qben1 - 1064*Qben2 + 1428*Qben4 - 1024*Qben6 + 385*Qben8 - 60*Qben10 + 350*Qstr1 - 1064*Qstr2 + 1428*Qstr4 - 1024*Qstr6 + 385*Qstr8 - 60*Qstr10))/(15*l*mu);
    y_dotdot2 = (42*(5*Fy6 + 42*Qben3 - 84*Qben5 + 72*Qben7 - 30*Qben9 + 5*Qben11 + 42*Qstr3 - 84*Qstr5 + 72*Qstr7 - 30*Qstr9 + 5*Qstr11))/(5*l*mu)-c*vy2;
    x_dotdot3 = (14*(280*Qben1 - 952*Qben2 + 1434*Qben4 - 1127*Qben6 + 455*Qben8 - 75*Qben10 + 280*Qstr1 - 952*Qstr2 + 1434*Qstr4 - 1127*Qstr6 + 455*Qstr8 - 75*Qstr10))/(5*l*mu);
    y_dotdot3 = -(42*(15*Fy6 + 84*Qben3 - 198*Qben5 + 189*Qben7 - 85*Qben9 + 15*Qben11 + 84*Qstr3 - 198*Qstr5 + 189*Qstr7 - 85*Qstr9 + 15*Qstr11))/(5*l*mu)-c*vy3;
    x_dotdot4 =-(14*(560*Qben1 - 2048*Qben2 + 3381*Qben4 - 2968*Qben6 + 1330*Qben8 - 240*Qben10 + 560*Qstr1 - 2048*Qstr2 + 3381*Qstr4 - 2968*Qstr6 + 1330*Qstr8 - 240*Qstr10))/(15*l*mu);
    y_dotdot4 = (14*(60*Fy6 + 216*Qben3 - 567*Qben5 + 616*Qben7 - 310*Qben9 + 60*Qben11 + 216*Qstr3 - 567*Qstr5 + 616*Qstr7 - 310*Qstr9 + 60*Qstr11))/(5*l*mu)-c*vy4;
    x_dotdot5 = (14*(40*Qben1 - 154*Qben2 + 273*Qben4 - 266*Qben6 + 140*Qben8 - 30*Qben10 + 40*Qstr1 - 154*Qstr2 + 273*Qstr4 - 266*Qstr6 + 140*Qstr8 - 30*Qstr10))/(3*l*mu);
    y_dotdot5 = -(2*(60*Fy6 + 126*Qben3 - 357*Qben5 + 434*Qben7 - 260*Qben9 + 60*Qben11 + 126*Qstr3 - 357*Qstr5 + 434*Qstr7 - 260*Qstr9 + 60*Qstr11))/(l*mu)-c*vy5;
    x_dotdot6 = -(2*(14*Qben1 - 56*Qben2 + 105*Qben4 - 112*Qben6 + 70*Qben8 - 24*Qben10 + 14*Qstr1 - 56*Qstr2 + 105*Qstr4 - 112*Qstr6 + 70*Qstr8 - 24*Qstr10))/(l*mu);
    y_dotdot6 = (3*(15*Fy6 + 14*Qben3 - 42*Qben5 + 56*Qben7 - 40*Qben9 + 15*Qben11 + 14*Qstr3 - 42*Qstr5 + 56*Qstr7 - 40*Qstr9 + 15*Qstr11))/(l*mu)-c*vy6;




    % Assemble the derivative of the state vector - expanded for 7 control points
    dXdt = zeros(22,1); % Expanded from 18 to 26 for 7 control points
    dXdt(1) = vx1;
    dXdt(2) = vx2;
    dXdt(3) = vy2;
    dXdt(4) = vx3;
    dXdt(5) = vy3;
    dXdt(6) = vx4;
    dXdt(7) = vy4;
    dXdt(8) = vx5;
    dXdt(9) = vy5;
    dXdt(10) = vx6; 
    dXdt(11) = vy6; 
    
    
    % The next components are the accelerations:
    dXdt(12) = x_dotdot1;
    dXdt(13) = x_dotdot2;
    dXdt(14) = y_dotdot2;
    dXdt(15) = x_dotdot3;
    dXdt(16) = y_dotdot3;
    dXdt(17) = x_dotdot4;
    dXdt(18) = y_dotdot4;
    dXdt(19) = x_dotdot5;
    dXdt(20) = y_dotdot5;
    dXdt(21) = x_dotdot6; 
    dXdt(22) = y_dotdot6; 
    
end

% Helper function for Gaussian quadrature 
function result = gauss_quad(func, a, b)
    % 7-point Gaussian quadrature for better accuracy
    % Points and weights for the standard interval [-1, 1]
    x = [-0.9491079123427585, -0.7415311855993945, -0.4058451513773972, ...
         0.0000000000000000, ...
         0.4058451513773972, 0.7415311855993945, 0.9491079123427585];
    
    w = [0.1294849661688697, 0.2797053914892766, 0.3818300505051189, ...
         0.4179591836734694, ...
         0.3818300505051189, 0.2797053914892766, 0.1294849661688697];
    
    % Transform to [a, b]
    x = 0.5*((b-a)*x + (b+a));
    w = 0.5*(b-a)*w;
    
    % Compute weighted sum
    result = 0;
    for i = 1:length(x)
        result = result + w(i) * func(x(i));
    end
end