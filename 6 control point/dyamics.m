clear
close all
clc
% Time span for the simulation

tspan = [0 6]; 

% Initial conditions:
% [ x1, x2, y2, x3, y3, x4, y4, x5, y5, vx1, vx2, vy2, vx3, vy3, vx4, vy4, vx5, vy5 ]
L = 1;
X0 = [L/5, 2*L/5, 0, 3*L/5, 0, 4*L/5, 0, L, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];

% Solve the ODE system using ode45
[t, X] = ode45(@myStateSpace, tspan, X0);

% 1. Plot positions (x1, x2, y2, x3, y3, x4, y4, x5, y5)
subplot(2, 2, 1);
plot(t, X(:,1), 'b-', t, X(:,2), 'b--', t, X(:,3), 'r-', t, X(:,4), 'g-', t, X(:,5), 'g--', t, X(:,6), 'm-', t, X(:,7), 'm--', t, X(:,8), 'c-', t, X(:,9), 'c--');
xlabel('Time');
ylabel('Position');
title('Positions');
legend('x1', 'x2', 'y2', 'x3', 'y3', 'x4', 'y4', 'x5', 'y5');
grid on;

% 2. Plot velocities (vx1, vx2, vy2, vx3, vy3, vx4, vy4, vx5, vy5)
subplot(2, 2, 2);
plot(t, X(:,10), 'b-', t, X(:,11), 'b--', t, X(:,12), 'r-', t, X(:,13), 'g-', t, X(:,14), 'g--', t, X(:,15), 'm-', t, X(:,16), 'm--', t, X(:,17), 'c-', t, X(:,18), 'c--');
xlabel('Time');
ylabel('Velocity');
title('Velocities');
legend('vx1', 'vx2', 'vy2', 'vx3', 'vy3', 'vx4', 'vy4', 'vx5', 'vy5');
grid on;

% 3. Plot trajectories (x1 vs y1, x2 vs y2, x3 vs y3, x4 vs y4, x5 vs y5)
subplot(2, 2, 3);
plot(X(:,1), zeros(length(X),1), 'b-', X(:,2), X(:,3), 'r-', X(:,4), X(:,5), 'g-', X(:,6), X(:,7), 'm-', X(:,8), X(:,9), 'c-');
xlabel('X Position');
ylabel('Y Position');
title('Trajectories');
legend('P1', 'P2', 'P3', 'P4', 'P5');
grid on;
axis equal;

% 4. Plot length of the beam over time using BÃ©zier curve length formula
subplot(2, 2, 4);
beam_length = arrayfun(@(i) bezier_length([0 0],[X(i,1), 0], [X(i,2), X(i,3)], [X(i,4), X(i,5)], [X(i,6), X(i,7)], [X(i,8), X(i,9)]), 1:length(t));
plot(t, beam_length, 'g-');
xlabel('Time');
ylabel('Beam Length');
title('Beam Length Over Time');
grid on;

% Calculate distances between control points
P0 = [0, 0]; % Origin
distances_P0P1 = zeros(length(t), 1);
distances_P1P2 = zeros(length(t), 1);
distances_P2P3 = zeros(length(t), 1);
distances_P3P4 = zeros(length(t), 1);
distances_P4P5 = zeros(length(t), 1);

for i = 1:length(t)
    P1 = [X(i,1), 0];
    P2 = [X(i,2), X(i,3)];
    P3 = [X(i,4), X(i,5)];
    P4 = [X(i,6), X(i,7)];
    P5 = [X(i,8), X(i,9)];
    
    % Calculate Euclidean distances
    distances_P0P1(i) = norm(P1 - P0);
    distances_P1P2(i) = norm(P2 - P1);
    distances_P2P3(i) = norm(P3 - P2);
    distances_P3P4(i) = norm(P4 - P3);
    distances_P4P5(i) = norm(P5 - P4);
end

% Create a new figure for distances between control points
figure;
plot(t, distances_P0P1, 'b-', t, distances_P1P2, 'r-', t, distances_P2P3, 'g-', t, distances_P3P4, 'm-', t, distances_P4P5, 'c-');
xlabel('Time');
ylabel('Distance');
title('Distances Between Control Points');
legend('P0-P1', 'P1-P2', 'P2-P3', 'P3-P4', 'P4-P5');
grid on;

% Calculate energies

%mechanical properties
D = 0.02;
E = 206e5;
I = (pi/64)*D^4;
rho = 1000;
A = (pi*D^2)/4; 
mu = rho*A;
L = 1;
l=L;

function length = bezier_length(P0, P1, P2, P3, P4, P5)
    % Define control point coordinates
    x0 = P0(1); y0 = P0(2);
    x1 = P1(1); y1 = P1(2);
    x2 = P2(1); y2 = P2(2);
    x3 = P3(1); y3 = P3(2);
    x4 = P4(1); y4 = P4(2);
    x5 = P5(1); y5 = P5(2);

    % Derivatives dx/dt and dy/dt as anonymous functions for quintic bezier
    dxdt = @(t) ...
        5*(1 - t).^4 * (x1 - x0) + ...
        20*(1 - t).^3.*t * (x2 - x1) + ...
        30*(1 - t).^2.*t.^2 * (x3 - x2) + ...
        20*(1 - t).*t.^3 * (x4 - x3) + ...
        5*t.^4 * (x5 - x4);

    dydt = @(t) ...
        5*(1 - t).^4 * (y1 - y0) + ...
        20*(1 - t).^3.*t * (y2 - y1) + ...
        30*(1 - t).^2.*t.^2 * (y3 - y2) + ...
        20*(1 - t).*t.^3 * (y4 - y3) + ...
        5*t.^4 * (y5 - y4);

    % Arc length integrand
    integrand = @(t) sqrt(dxdt(t).^2 + dydt(t).^2);

    % Numerically integrate from t = 0 to t = 1
    length = integral(integrand, 0, 1);
end

function dXdt = myStateSpace(t, X)
    % Extract variables from the state vector
    x_1 = X(1);
    x_2 = X(2);
    y_2 = X(3);
    x_3 = X(4);
    y_3 = X(5);
    x_4 = X(6);
    y_4 = X(7);
    x_5 = X(8);
    y_5 = X(9);
    vx1 = X(10);
    vx2 = X(11);
    vy2 = X(12);
    vx3 = X(13);
    vy3 = X(14);
    vx4 = X(15);
    vy4 = X(16);
    vx5 = X(17);
    vy5 = X(18);
    
    %mechanical properties
    D = 0.02;
    E = 206e5;
    I = (pi/64)*D^4;
    rho = 1000;
    A = (pi*D^2)/4; 
    mu = rho*A;
    L = 1;
    l=L;

    %damping coefficient
    c=3.5;

   % Define forces (if F!=0 when calculating equations of motion)
    if t >= 0 && t <= 6
        Fy5 = -0.5; % Force applied to the 5th control point
    else
        Fy5 = 0;
    end
 
    % Bending and stretching terms
    ben1 = @(u) (8.*((5.*x_1.*(u - 1).^4 - 5.*u.^4.*x_4 + 5.*u.^4.*x_5 + 20.*u.*x_1.*(u - 1).^3 - 20.*u.*x_2.*(u - 1).^3 - 20.*u.^3.*x_4.*(u - 1) + 10.*u.^3.*x_3.*(2.*u - 2) - 30.*u.^2.*x_2.*(u - 1).^2 + 30.*u.^2.*x_3.*(u - 1).^2).*(20.*y_2 - 180.*u.*y_2 + 60.*u.*y_3 + 360.*u.^2.*y_2 - 240.*u.^2.*y_3 - 200.*u.^3.*y_2 + 60.*u.^2.*y_4 + 200.*u.^3.*y_3 - 100.*u.^3.*y_4 + 20.*u.^3.*y_5) - 5.*u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(20.*x_2 - 40.*x_1 + 180.*u.*x_1 - 180.*u.*x_2 + 60.*u.*x_3 - 240.*u.^2.*x_1 + 360.*u.^2.*x_2 + 100.*u.^3.*x_1 - 240.*u.^2.*x_3 - 200.*u.^3.*x_2 + 60.*u.^2.*x_4 + 200.*u.^3.*x_3 - 100.*u.^3.*x_4 + 20.*u.^3.*x_5)).*(u - 1).^2.*(y_2 - 7.*u.*y_2 + 3.*u.*y_3 + 21.*u.^2.*y_2 - 18.*u.^2.*y_3 - 25.*u.^3.*y_2 + 3.*u.^2.*y_4 + 35.*u.^3.*y_3 + 10.*u.^4.*y_2 - 15.*u.^3.*y_4 - 20.*u.^4.*y_3 + u.^3.*y_5 + 15.*u.^4.*y_4 - 4.*u.^4.*y_5))./(625.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^3) - (96.*(5.*u - 1).*((x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).*(y_2 - 9.*u.*y_2 + 3.*u.*y_3 + 18.*u.^2.*y_2 - 12.*u.^2.*y_3 - 10.*u.^3.*y_2 + 3.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5) - u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(x_2 - 2.*x_1 + 9.*u.*x_1 - 9.*u.*x_2 + 3.*u.*x_3 - 12.*u.^2.*x_1 + 18.*u.^2.*x_2 + 5.*u.^3.*x_1 - 12.*u.^2.*x_3 - 10.*u.^3.*x_2 + 3.*u.^2.*x_4 + 10.*u.^3.*x_3 - 5.*u.^3.*x_4 + u.^3.*x_5)).^2.*(u - 1).^3.*(5.*x_1.*(u - 1).^4 - 5.*u.^4.*x_4 + 5.*u.^4.*x_5 + 20.*u.*x_1.*(u - 1).^3 - 20.*u.*x_2.*(u - 1).^3 - 20.*u.^3.*x_4.*(u - 1) + 10.*u.^3.*x_3.*(2.*u - 2) - 30.*u.^2.*x_2.*(u - 1).^2 + 30.*u.^2.*x_3.*(u - 1).^2))./(125.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^4); % 
    ben2 = @(u) (192.*u.*(5.*u - 2).*((x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).*(y_2 - 9.*u.*y_2 + 3.*u.*y_3 + 18.*u.^2.*y_2 - 12.*u.^2.*y_3 - 10.*u.^3.*y_2 + 3.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5) - u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(x_2 - 2.*x_1 + 9.*u.*x_1 - 9.*u.*x_2 + 3.*u.*x_3 - 12.*u.^2.*x_1 + 18.*u.^2.*x_2 + 5.*u.^3.*x_1 - 12.*u.^2.*x_3 - 10.*u.^3.*x_2 + 3.*u.^2.*x_4 + 10.*u.^3.*x_3 - 5.*u.^3.*x_4 + u.^3.*x_5)).^2.*(u - 1).^2.*(5.*x_1.*(u - 1).^4 - 5.*u.^4.*x_4 + 5.*u.^4.*x_5 + 20.*u.*x_1.*(u - 1).^3 - 20.*u.*x_2.*(u - 1).^3 - 20.*u.^3.*x_4.*(u - 1) + 10.*u.^3.*x_3.*(2.*u - 2) - 30.*u.^2.*x_2.*(u - 1).^2 + 30.*u.^2.*x_3.*(u - 1).^2))./(125.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^4) - (8.*u.^2.*((5.*x_1.*(u - 1).^4 - 5.*u.^4.*x_4 + 5.*u.^4.*x_5 + 20.*u.*x_1.*(u - 1).^3 - 20.*u.*x_2.*(u - 1).^3 - 20.*u.^3.*x_4.*(u - 1) + 10.*u.^3.*x_3.*(2.*u - 2) - 30.*u.^2.*x_2.*(u - 1).^2 + 30.*u.^2.*x_3.*(u - 1).^2).*(20.*y_2 - 180.*u.*y_2 + 60.*u.*y_3 + 360.*u.^2.*y_2 - 240.*u.^2.*y_3 - 200.*u.^3.*y_2 + 60.*u.^2.*y_4 + 200.*u.^3.*y_3 - 100.*u.^3.*y_4 + 20.*u.^3.*y_5) - 5.*u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(20.*x_2 - 40.*x_1 + 180.*u.*x_1 - 180.*u.*x_2 + 60.*u.*x_3 - 240.*u.^2.*x_1 + 360.*u.^2.*x_2 + 100.*u.^3.*x_1 - 240.*u.^2.*x_3 - 200.*u.^3.*x_2 + 60.*u.^2.*x_4 + 200.*u.^3.*x_3 - 100.*u.^3.*x_4 + 20.*u.^3.*x_5)).*(u - 1).*(6.*y_3 - 26.*u.*y_3 + 8.*u.*y_4 + 40.*u.^2.*y_3 - 25.*u.^2.*y_4 - 20.*u.^3.*y_3 + 3.*u.^2.*y_5 + 20.*u.^3.*y_4 - 6.*u.^3.*y_5))./(625.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^3); % 
    ben3 = @(u) (8.*((5.*x_1.*(u - 1).^4 - 5.*u.^4.*x_4 + 5.*u.^4.*x_5 + 20.*u.*x_1.*(u - 1).^3 - 20.*u.*x_2.*(u - 1).^3 - 20.*u.^3.*x_4.*(u - 1) + 10.*u.^3.*x_3.*(2.*u - 2) - 30.*u.^2.*x_2.*(u - 1).^2 + 30.*u.^2.*x_3.*(u - 1).^2).*(20.*y_2 - 180.*u.*y_2 + 60.*u.*y_3 + 360.*u.^2.*y_2 - 240.*u.^2.*y_3 - 200.*u.^3.*y_2 + 60.*u.^2.*y_4 + 200.*u.^3.*y_3 - 100.*u.^3.*y_4 + 20.*u.^3.*y_5) - 5.*u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(20.*x_2 - 40.*x_1 + 180.*u.*x_1 - 180.*u.*x_2 + 60.*u.*x_3 - 240.*u.^2.*x_1 + 360.*u.^2.*x_2 + 100.*u.^3.*x_1 - 240.*u.^2.*x_3 - 200.*u.^3.*x_2 + 60.*u.^2.*x_4 + 200.*u.^3.*x_3 - 100.*u.^3.*x_4 + 20.*u.^3.*x_5)).*(u - 1).*(8.*u.*x_1 - x_1 - 28.*u.^2.*x_1 + 46.*u.^3.*x_1 + 6.*u.^2.*x_3 - 35.*u.^4.*x_1 - 26.*u.^3.*x_3 + 10.*u.^5.*x_1 + 8.*u.^3.*x_4 + 40.*u.^4.*x_3 - 25.*u.^4.*x_4 - 20.*u.^5.*x_3 + 3.*u.^4.*x_5 + 20.*u.^5.*x_4 - 6.*u.^5.*x_5))./(625.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^3) + (192.*u.^2.*(5.*u - 2).*((x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).*(y_2 - 9.*u.*y_2 + 3.*u.*y_3 + 18.*u.^2.*y_2 - 12.*u.^2.*y_3 - 10.*u.^3.*y_2 + 3.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5) - u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(x_2 - 2.*x_1 + 9.*u.*x_1 - 9.*u.*x_2 + 3.*u.*x_3 - 12.*u.^2.*x_1 + 18.*u.^2.*x_2 + 5.*u.^3.*x_1 - 12.*u.^2.*x_3 - 10.*u.^3.*x_2 + 3.*u.^2.*x_4 + 10.*u.^3.*x_3 - 5.*u.^3.*x_4 + u.^3.*x_5)).^2.*(u - 1).^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5))./(25.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^4); % 
    ben4 = @(u) -(8.*u.^2.*((5.*x_1.*(u - 1).^4 - 5.*u.^4.*x_4 + 5.*u.^4.*x_5 + 20.*u.*x_1.*(u - 1).^3 - 20.*u.*x_2.*(u - 1).^3 - 20.*u.^3.*x_4.*(u - 1) + 10.*u.^3.*x_3.*(2.*u - 2) - 30.*u.^2.*x_2.*(u - 1).^2 + 30.*u.^2.*x_3.*(u - 1).^2).*(20.*y_2 - 180.*u.*y_2 + 60.*u.*y_3 + 360.*u.^2.*y_2 - 240.*u.^2.*y_3 - 200.*u.^3.*y_2 + 60.*u.^2.*y_4 + 200.*u.^3.*y_3 - 100.*u.^3.*y_4 + 20.*u.^3.*y_5) - 5.*u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(20.*x_2 - 40.*x_1 + 180.*u.*x_1 - 180.*u.*x_2 + 60.*u.*x_3 - 240.*u.^2.*x_1 + 360.*u.^2.*x_2 + 100.*u.^3.*x_1 - 240.*u.^2.*x_3 - 200.*u.^3.*x_2 + 60.*u.^2.*x_4 + 200.*u.^3.*x_3 - 100.*u.^3.*x_4 + 20.*u.^3.*x_5)).*(6.*y_2 - 32.*u.*y_2 + 66.*u.^2.*y_2 - 60.*u.^3.*y_2 - 6.*u.^2.*y_4 + 20.*u.^4.*y_2 + 15.*u.^3.*y_4 - 3.*u.^3.*y_5 - 10.*u.^4.*y_4 + 4.*u.^4.*y_5))./(625.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^3) - (192.*u.^2.*((x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).*(y_2 - 9.*u.*y_2 + 3.*u.*y_3 + 18.*u.^2.*y_2 - 12.*u.^2.*y_3 - 10.*u.^3.*y_2 + 3.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5) - u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(x_2 - 2.*x_1 + 9.*u.*x_1 - 9.*u.*x_2 + 3.*u.*x_3 - 12.*u.^2.*x_1 + 18.*u.^2.*x_2 + 5.*u.^3.*x_1 - 12.*u.^2.*x_3 - 10.*u.^3.*x_2 + 3.*u.^2.*x_4 + 10.*u.^3.*x_3 - 5.*u.^3.*x_4 + u.^3.*x_5)).^2.*(5.*u.^2 - 8.*u + 3).*(5.*x_1.*(u - 1).^4 - 5.*u.^4.*x_4 + 5.*u.^4.*x_5 + 20.*u.*x_1.*(u - 1).^3 - 20.*u.*x_2.*(u - 1).^3 - 20.*u.^3.*x_4.*(u - 1) + 10.*u.^3.*x_3.*(2.*u - 2) - 30.*u.^2.*x_2.*(u - 1).^2 + 30.*u.^2.*x_3.*(u - 1).^2))./(125.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^4); % 
    ben5 = @(u) (8.*u.*((5.*x_1.*(u - 1).^4 - 5.*u.^4.*x_4 + 5.*u.^4.*x_5 + 20.*u.*x_1.*(u - 1).^3 - 20.*u.*x_2.*(u - 1).^3 - 20.*u.^3.*x_4.*(u - 1) + 10.*u.^3.*x_3.*(2.*u - 2) - 30.*u.^2.*x_2.*(u - 1).^2 + 30.*u.^2.*x_3.*(u - 1).^2).*(20.*y_2 - 180.*u.*y_2 + 60.*u.*y_3 + 360.*u.^2.*y_2 - 240.*u.^2.*y_3 - 200.*u.^3.*y_2 + 60.*u.^2.*y_4 + 200.*u.^3.*y_3 - 100.*u.^3.*y_4 + 20.*u.^3.*y_5) - 5.*u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(20.*x_2 - 40.*x_1 + 180.*u.*x_1 - 180.*u.*x_2 + 60.*u.*x_3 - 240.*u.^2.*x_1 + 360.*u.^2.*x_2 + 100.*u.^3.*x_1 - 240.*u.^2.*x_3 - 200.*u.^3.*x_2 + 60.*u.^2.*x_4 + 200.*u.^3.*x_3 - 100.*u.^3.*x_4 + 20.*u.^3.*x_5)).*(3.*x_1 - 24.*u.*x_1 + 6.*u.*x_2 + 74.*u.^2.*x_1 - 32.*u.^2.*x_2 - 108.*u.^3.*x_1 + 66.*u.^3.*x_2 + 75.*u.^4.*x_1 - 60.*u.^4.*x_2 - 20.*u.^5.*x_1 - 6.*u.^3.*x_4 + 20.*u.^5.*x_2 + 15.*u.^4.*x_4 - 3.*u.^4.*x_5 - 10.*u.^5.*x_4 + 4.*u.^5.*x_5))./(625.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^3) - (192.*u.^3.*((x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).*(y_2 - 9.*u.*y_2 + 3.*u.*y_3 + 18.*u.^2.*y_2 - 12.*u.^2.*y_3 - 10.*u.^3.*y_2 + 3.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5) - u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(x_2 - 2.*x_1 + 9.*u.*x_1 - 9.*u.*x_2 + 3.*u.*x_3 - 12.*u.^2.*x_1 + 18.*u.^2.*x_2 + 5.*u.^3.*x_1 - 12.*u.^2.*x_3 - 10.*u.^3.*x_2 + 3.*u.^2.*x_4 + 10.*u.^3.*x_3 - 5.*u.^3.*x_4 + u.^3.*x_5)).^2.*(5.*u.^2 - 8.*u + 3).*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5))./(25.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^4); % 
    ben6 = @(u) (96.*u.^3.*(5.*u - 4).*((x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).*(y_2 - 9.*u.*y_2 + 3.*u.*y_3 + 18.*u.^2.*y_2 - 12.*u.^2.*y_3 - 10.*u.^3.*y_2 + 3.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5) - u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(x_2 - 2.*x_1 + 9.*u.*x_1 - 9.*u.*x_2 + 3.*u.*x_3 - 12.*u.^2.*x_1 + 18.*u.^2.*x_2 + 5.*u.^3.*x_1 - 12.*u.^2.*x_3 - 10.*u.^3.*x_2 + 3.*u.^2.*x_4 + 10.*u.^3.*x_3 - 5.*u.^3.*x_4 + u.^3.*x_5)).^2.*(5.*x_1.*(u - 1).^4 - 5.*u.^4.*x_4 + 5.*u.^4.*x_5 + 20.*u.*x_1.*(u - 1).^3 - 20.*u.*x_2.*(u - 1).^3 - 20.*u.^3.*x_4.*(u - 1) + 10.*u.^3.*x_3.*(2.*u - 2) - 30.*u.^2.*x_2.*(u - 1).^2 + 30.*u.^2.*x_3.*(u - 1).^2))./(125.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^4) - (8.*u.^3.*((5.*x_1.*(u - 1).^4 - 5.*u.^4.*x_4 + 5.*u.^4.*x_5 + 20.*u.*x_1.*(u - 1).^3 - 20.*u.*x_2.*(u - 1).^3 - 20.*u.^3.*x_4.*(u - 1) + 10.*u.^3.*x_3.*(2.*u - 2) - 30.*u.^2.*x_2.*(u - 1).^2 + 30.*u.^2.*x_3.*(u - 1).^2).*(20.*y_2 - 180.*u.*y_2 + 60.*u.*y_3 + 360.*u.^2.*y_2 - 240.*u.^2.*y_3 - 200.*u.^3.*y_2 + 60.*u.^2.*y_4 + 200.*u.^3.*y_3 - 100.*u.^3.*y_4 + 20.*u.^3.*y_5) - 5.*u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(20.*x_2 - 40.*x_1 + 180.*u.*x_1 - 180.*u.*x_2 + 60.*u.*x_3 - 240.*u.^2.*x_1 + 360.*u.^2.*x_2 + 100.*u.^3.*x_1 - 240.*u.^2.*x_3 - 200.*u.^3.*x_2 + 60.*u.^2.*x_4 + 200.*u.^3.*x_3 - 100.*u.^3.*x_4 + 20.*u.^3.*x_5)).*(8.*y_2 - 33.*u.*y_2 + 6.*u.*y_3 + 45.*u.^2.*y_2 - 15.*u.^2.*y_3 - 20.*u.^3.*y_2 + 10.*u.^3.*y_3 - u.^3.*y_5))./(625.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^3); % 
    ben7 = @(u) (8.*u.^2.*((5.*x_1.*(u - 1).^4 - 5.*u.^4.*x_4 + 5.*u.^4.*x_5 + 20.*u.*x_1.*(u - 1).^3 - 20.*u.*x_2.*(u - 1).^3 - 20.*u.^3.*x_4.*(u - 1) + 10.*u.^3.*x_3.*(2.*u - 2) - 30.*u.^2.*x_2.*(u - 1).^2 + 30.*u.^2.*x_3.*(u - 1).^2).*(20.*y_2 - 180.*u.*y_2 + 60.*u.*y_3 + 360.*u.^2.*y_2 - 240.*u.^2.*y_3 - 200.*u.^3.*y_2 + 60.*u.^2.*y_4 + 200.*u.^3.*y_3 - 100.*u.^3.*y_4 + 20.*u.^3.*y_5) - 5.*u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(20.*x_2 - 40.*x_1 + 180.*u.*x_1 - 180.*u.*x_2 + 60.*u.*x_3 - 240.*u.^2.*x_1 + 360.*u.^2.*x_2 + 100.*u.^3.*x_1 - 240.*u.^2.*x_3 - 200.*u.^3.*x_2 + 60.*u.^2.*x_4 + 200.*u.^3.*x_3 - 100.*u.^3.*x_4 + 20.*u.^3.*x_5)).*(3.*x_1 - 21.*u.*x_1 + 8.*u.*x_2 + 48.*u.^2.*x_1 - 33.*u.^2.*x_2 - 45.*u.^3.*x_1 + 6.*u.^2.*x_3 + 45.*u.^3.*x_2 + 15.*u.^4.*x_1 - 15.*u.^3.*x_3 - 20.*u.^4.*x_2 + 10.*u.^4.*x_3 - u.^4.*x_5))./(625.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^3) + (96.*u.^4.*(5.*u - 4).*((x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).*(y_2 - 9.*u.*y_2 + 3.*u.*y_3 + 18.*u.^2.*y_2 - 12.*u.^2.*y_3 - 10.*u.^3.*y_2 + 3.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5) - u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(x_2 - 2.*x_1 + 9.*u.*x_1 - 9.*u.*x_2 + 3.*u.*x_3 - 12.*u.^2.*x_1 + 18.*u.^2.*x_2 + 5.*u.^3.*x_1 - 12.*u.^2.*x_3 - 10.*u.^3.*x_2 + 3.*u.^2.*x_4 + 10.*u.^3.*x_3 - 5.*u.^3.*x_4 + u.^3.*x_5)).^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5))./(25.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^4); % 
    ben8 = @(u) - (8.*u.^4.*((5.*x_1.*(u - 1).^4 - 5.*u.^4.*x_4 + 5.*u.^4.*x_5 + 20.*u.*x_1.*(u - 1).^3 - 20.*u.*x_2.*(u - 1).^3 - 20.*u.^3.*x_4.*(u - 1) + 10.*u.^3.*x_3.*(2.*u - 2) - 30.*u.^2.*x_2.*(u - 1).^2 + 30.*u.^2.*x_3.*(u - 1).^2).*(20.*y_2 - 180.*u.*y_2 + 60.*u.*y_3 + 360.*u.^2.*y_2 - 240.*u.^2.*y_3 - 200.*u.^3.*y_2 + 60.*u.^2.*y_4 + 200.*u.^3.*y_3 - 100.*u.^3.*y_4 + 20.*u.^3.*y_5) - 5.*u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(20.*x_2 - 40.*x_1 + 180.*u.*x_1 - 180.*u.*x_2 + 60.*u.*x_3 - 240.*u.^2.*x_1 + 360.*u.^2.*x_2 + 100.*u.^3.*x_1 - 240.*u.^2.*x_3 - 200.*u.^3.*x_2 + 60.*u.^2.*x_4 + 200.*u.^3.*x_3 - 100.*u.^3.*x_4 + 20.*u.^3.*x_5)).*(3.*y_2 - 9.*u.*y_2 + 3.*u.*y_3 + 6.*u.^2.*y_2 - 4.*u.^2.*y_3 + u.^2.*y_4))./(625.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^3) - (96.*u.^4.*((x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).*(y_2 - 9.*u.*y_2 + 3.*u.*y_3 + 18.*u.^2.*y_2 - 12.*u.^2.*y_3 - 10.*u.^3.*y_2 + 3.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5) - u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(x_2 - 2.*x_1 + 9.*u.*x_1 - 9.*u.*x_2 + 3.*u.*x_3 - 12.*u.^2.*x_1 + 18.*u.^2.*x_2 + 5.*u.^3.*x_1 - 12.*u.^2.*x_3 - 10.*u.^3.*x_2 + 3.*u.^2.*x_4 + 10.*u.^3.*x_3 - 5.*u.^3.*x_4 + u.^3.*x_5)).^2.*(5.*x_1.*(u - 1).^4 - 5.*u.^4.*x_4 + 5.*u.^4.*x_5 + 20.*u.*x_1.*(u - 1).^3 - 20.*u.*x_2.*(u - 1).^3 - 20.*u.^3.*x_4.*(u - 1) + 10.*u.^3.*x_3.*(2.*u - 2) - 30.*u.^2.*x_2.*(u - 1).^2 + 30.*u.^2.*x_3.*(u - 1).^2))./(125.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^4); % 
    ben9 = @(u) (8.*u.^3.*((5.*x_1.*(u - 1).^4 - 5.*u.^4.*x_4 + 5.*u.^4.*x_5 + 20.*u.*x_1.*(u - 1).^3 - 20.*u.*x_2.*(u - 1).^3 - 20.*u.^3.*x_4.*(u - 1) + 10.*u.^3.*x_3.*(2.*u - 2) - 30.*u.^2.*x_2.*(u - 1).^2 + 30.*u.^2.*x_3.*(u - 1).^2).*(20.*y_2 - 180.*u.*y_2 + 60.*u.*y_3 + 360.*u.^2.*y_2 - 240.*u.^2.*y_3 - 200.*u.^3.*y_2 + 60.*u.^2.*y_4 + 200.*u.^3.*y_3 - 100.*u.^3.*y_4 + 20.*u.^3.*y_5) - 5.*u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(20.*x_2 - 40.*x_1 + 180.*u.*x_1 - 180.*u.*x_2 + 60.*u.*x_3 - 240.*u.^2.*x_1 + 360.*u.^2.*x_2 + 100.*u.^3.*x_1 - 240.*u.^2.*x_3 - 200.*u.^3.*x_2 + 60.*u.^2.*x_4 + 200.*u.^3.*x_3 - 100.*u.^3.*x_4 + 20.*u.^3.*x_5)).*(x_1 - 6.*u.*x_1 + 3.*u.*x_2 + 9.*u.^2.*x_1 - 9.*u.^2.*x_2 - 4.*u.^3.*x_1 + 3.*u.^2.*x_3 + 6.*u.^3.*x_2 - 4.*u.^3.*x_3 + u.^3.*x_4))./(625.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^3) - (96.*u.^5.*((x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).*(y_2 - 9.*u.*y_2 + 3.*u.*y_3 + 18.*u.^2.*y_2 - 12.*u.^2.*y_3 - 10.*u.^3.*y_2 + 3.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5) - u.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).*(x_2 - 2.*x_1 + 9.*u.*x_1 - 9.*u.*x_2 + 3.*u.*x_3 - 12.*u.^2.*x_1 + 18.*u.^2.*x_2 + 5.*u.^3.*x_1 - 12.*u.^2.*x_3 - 10.*u.^3.*x_2 + 3.*u.^2.*x_4 + 10.*u.^3.*x_3 - 5.*u.^3.*x_4 + u.^3.*x_5)).^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5))./(25.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^4); % 
    
    str1 = @(u) (10.*(5.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2) - 1).*(4.*u.*(u - 1).^3 + (u - 1).^4).*(x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2))./(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2); % 
    str2 = @(u) -(10.*(5.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2) - 1).*(4.*u.*(u - 1).^3 + 6.*u.^2.*(u - 1).^2).*(x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2))./(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2); % 
    str3 = @(u) -(10.*u.^2.*(5.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2) - 1).*(10.*u.^3 - 24.*u.^2 + 18.*u - 4).*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5))./(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2); % 
    str4 = @(u) (10.*(5.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2) - 1).*(4.*u.^3.*(u - 1) + 6.*u.^2.*(u - 1).^2).*(x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2))./(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2); % 
    str5 = @(u) (10.*u.^2.*(5.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2) - 1).*(10.*u.^3 - 16.*u.^2 + 6.*u).*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5))./(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2); % 
    str6 = @(u) -(10.*(4.*u.^3.*(u - 1) + u.^4).*(5.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2) - 1).*(x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2))./(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2); % 
    str7 = @(u) (10.*u.^2.*(5.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2) - 1).*(- 5.*u.^3 + 4.*u.^2).*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5))./(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2); % 
    str8 = @(u) (10.*u.^4.*(5.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2) - 1).*(x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2))./(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2); % 
    str9 = @(u) (10.*u.^5.*(5.*(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2) - 1).*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5))./(u.^2.*(4.*y_2 - 18.*u.*y_2 + 6.*u.*y_3 + 24.*u.^2.*y_2 - 16.*u.^2.*y_3 - 10.*u.^3.*y_2 + 4.*u.^2.*y_4 + 10.*u.^3.*y_3 - 5.*u.^3.*y_4 + u.^3.*y_5).^2 + (x_1.*(u - 1).^4 - u.^4.*x_4 + u.^4.*x_5 + 4.*u.*x_1.*(u - 1).^3 - 4.*u.*x_2.*(u - 1).^3 + 4.*u.^3.*x_3.*(u - 1) - 4.*u.^3.*x_4.*(u - 1) - 6.*u.^2.*x_2.*(u - 1).^2 + 6.*u.^2.*x_3.*(u - 1).^2).^2).^(1./2); %
    

    % Using Gaussian quadrature instead of integral function
    Qben1 = (-1/2)*E*I*L*gauss_quad(ben1, 0, 1);
    Qben2 = (-1/2)*E*I*L*gauss_quad(ben2, 0, 1);
    Qben3 = (-1/2)*E*I*L*gauss_quad(ben3, 0, 1);
    Qben4 = (-1/2)*E*I*L*gauss_quad(ben4, 0, 1);
    Qben5 = (-1/2)*E*I*L*gauss_quad(ben5, 0, 1);
    Qben6 = (-1/2)*E*I*L*gauss_quad(ben6, 0, 1);
    Qben7 = (-1/2)*E*I*L*gauss_quad(ben7, 0, 1);
    Qben8 = (-1/2)*E*I*L*gauss_quad(ben8, 0, 1);
    Qben9 = (-1/2)*E*I*L*gauss_quad(ben9, 0, 1);
    
    Qstr1 = (-1/2) * E * A * L * gauss_quad(str1, 0, 1);
    Qstr2 = (-1/2) * E * A * L * gauss_quad(str2, 0, 1);
    Qstr3 = (-1/2) * E * A * L * gauss_quad(str3, 0, 1);
    Qstr4 = (-1/2) * E * A * L * gauss_quad(str4, 0, 1);
    Qstr5 = (-1/2) * E * A * L * gauss_quad(str5, 0, 1);
    Qstr6 = (-1/2) * E * A * L * gauss_quad(str6, 0, 1);
    Qstr7 = (-1/2) * E * A * L * gauss_quad(str7, 0, 1);
    Qstr8 = (-1/2) * E * A * L * gauss_quad(str8, 0, 1);
    Qstr9 = (-1/2) * E * A * L * gauss_quad(str9, 0, 1);
    

    % Acceleration equations - using placeholders for the 6-point spline
    x_dotdot1 = (21*(35*Qben1 - 70*Qben2 + 63*Qben4 - 28*Qben6 + 5*Qben8 + 35*Qstr1 - 70*Qstr2 + 63*Qstr4 - 28*Qstr6 + 5*Qstr8))/(5*l*mu); %  
    x_dotdot2 = -(14*(105*Qben1 - 266*Qben2 + 273*Qben4 - 132*Qben6 + 25*Qben8 + 105*Qstr1 - 266*Qstr2 + 273*Qstr4 - 132*Qstr6 + 25*Qstr8))/(5*l*mu); % 
    y_dotdot2 = -(28*(5*Fy5 - 28*Qben3 + 42*Qben5 - 24*Qben7 + 5*Qben9 - 28*Qstr3 + 42*Qstr5 - 24*Qstr7 + 5*Qstr9))/(5*l*mu)-c*vy2; %  
    x_dotdot3 = (21*(63*Qben1 - 182*Qben2 + 219*Qben4 - 120*Qben6 + 25*Qben8 + 63*Qstr1 - 182*Qstr2 + 219*Qstr4 - 120*Qstr6 + 25*Qstr8))/(5*l*mu); % 
    y_dotdot3 = (84*(20*Fy5 - 70*Qben3 + 132*Qben5 - 87*Qben7 + 20*Qben9 - 70*Qstr3 + 132*Qstr5 - 87*Qstr7 + 20*Qstr9))/(25*l*mu)-c*vy3; %  
    x_dotdot4 = -(84*(7*Qben1 - 22*Qben2 + 30*Qben4 - 20*Qben6 + 5*Qben8 + 7*Qstr1 - 22*Qstr2 + 30*Qstr4 - 20*Qstr6 + 5*Qstr8))/(5*l*mu); %  
    y_dotdot4 = -(84*(20*Fy5 - 40*Qben3 + 87*Qben5 - 72*Qben7 + 20*Qben9 - 40*Qstr3 + 87*Qstr5 - 72*Qstr7 + 20*Qstr9))/(25*l*mu)-c*vy4; %  
    x_dotdot5 = (7*(3*Qben1 - 10*Qben2 + 15*Qben4 - 12*Qben6 + 5*Qben8 + 3*Qstr1 - 10*Qstr2 + 15*Qstr4 - 12*Qstr6 + 5*Qstr8))/(l*mu); % 
    y_dotdot5 = (4*(40*Fy5 - 35*Qben3 + 84*Qben5 - 84*Qben7 + 40*Qben9 - 35*Qstr3 + 84*Qstr5 - 84*Qstr7 + 40*Qstr9))/(5*l*mu)-c*vy5; % 

    % Assemble the derivative of the state vector
    dXdt = zeros(18,1);
    dXdt(1) = vx1;
    dXdt(2) = vx2;
    dXdt(3) = vy2;
    dXdt(4) = vx3;
    dXdt(5) = vy3;
    dXdt(6) = vx4;
    dXdt(7) = vy4;
    dXdt(8) = vx5;
    dXdt(9) = vy5;
    
    % The next components are the accelerations:
    dXdt(10) = x_dotdot1;
    dXdt(11) = x_dotdot2;
    dXdt(12) = y_dotdot2;
    dXdt(13) = x_dotdot3;
    dXdt(14) = y_dotdot3;
    dXdt(15) = x_dotdot4;
    dXdt(16) = y_dotdot4;
    dXdt(17) = x_dotdot5;
    dXdt(18) = y_dotdot5;
end

% Helper function for Gaussian quadrature 
function result = gauss_quad(func, a, b)
    % 7-point Gaussian quadrature for better accuracy
    % Points and weights for the standard interval [-1, 1]
    x = [-0.9491079123427585, -0.7415311855993945, -0.4058451513773972, ...
         0.0000000000000000, ...
         0.4058451513773972, 0.7415311855993945, 0.9491079123427585];
    
    w = [0.1294849661688697, 0.2797053914892766, 0.3818300505051189, ...
         0.4179591836734694, ...
         0.3818300505051189, 0.2797053914892766, 0.1294849661688697];
    
    % Transform to [a, b]
    x = 0.5*((b-a)*x + (b+a));
    w = 0.5*(b-a)*w;
    
    % Compute weighted sum
    result = 0;
    for i = 1:length(x)
        result = result + w(i) * func(x(i));
    end
end